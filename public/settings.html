<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RIBH | Settings</title>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{
            --bg:#09090B;--bg-raised:#18181B;
            --card:#18181B;--card-hover:#1F1F23;
            --border:#27272A;--border-hover:#3F3F46;
            --text:#FAFAFA;--text-secondary:#A1A1AA;--text-muted:#71717A;
            --primary:#10B981;--primary-hover:#059669;--primary-muted:rgba(16,185,129,0.15);
            --secondary:#6366F1;--secondary-muted:rgba(99,102,241,0.15);
            --success:#22C55E;--warning:#F59E0B;--danger:#EF4444;
            --ring:rgba(16,185,129,0.3);
            --radius:12px;--radius-sm:8px;--radius-lg:16px;
            --sidebar-w:220px;
        }
        html{scroll-behavior:smooth;overflow-x:hidden;max-width:100vw}
        html[dir="ltr"]{font-family:'Inter',system-ui,sans-serif}
        html[dir="rtl"]{font-family:'IBM Plex Sans Arabic','Inter',system-ui,sans-serif}
        body{background:var(--bg);color:var(--text);min-height:100vh;overflow-x:hidden;font-size:14px;line-height:1.5;width:100%;max-width:100vw}

        /* Sidebar - identical to dashboard */
        .sidebar{width:var(--sidebar-w);background:var(--bg);border-left:1px solid var(--border);position:fixed;height:100vh;z-index:100;display:flex;flex-direction:column;padding:16px 12px;overflow-y:auto}
        html[dir="rtl"] .sidebar{right:0;border-left:1px solid var(--border);border-right:none}
        html[dir="ltr"] .sidebar{left:0;border-right:1px solid var(--border);border-left:none}
        .sb-logo{display:flex;align-items:center;gap:10px;padding:8px 12px;margin-bottom:24px}
        .sb-logo-mark{width:32px;height:32px;background:linear-gradient(135deg,#10B981,#059669);border-radius:8px;display:flex;align-items:center;justify-content:center}
        .sb-logo-mark svg{color:white}
        .sb-logo-text{font-size:18px;font-weight:700;letter-spacing:-0.02em}
        .sb-section{margin-bottom:20px}
        .sb-section-label{font-size:11px;font-weight:600;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.05em;padding:0 12px;margin-bottom:6px}
        .sb-item{display:flex;align-items:center;gap:10px;padding:9px 12px;border-radius:var(--radius-sm);color:var(--text-secondary);cursor:pointer;transition:all .15s;font-size:13px;font-weight:500;text-decoration:none}
        .sb-item:hover{background:var(--bg-raised);color:var(--text)}
        .sb-item.active{background:var(--primary-muted);color:var(--primary)}
        .sb-item.active svg{color:var(--primary)}
        .sb-item svg{width:18px;height:18px;flex-shrink:0;color:var(--text-muted)}
        .sb-item:hover svg{color:var(--text-secondary)}
        .sb-spacer{flex:1}
        .sb-status{display:flex;align-items:center;gap:8px;padding:10px 12px;border-radius:var(--radius-sm);background:var(--bg-raised);font-size:12px;color:var(--text-secondary);margin-bottom:8px}
        .sb-dot{width:7px;height:7px;border-radius:50%;background:var(--success);flex-shrink:0}
        .sb-dot.pulse{animation:dotPulse 2s infinite}
        @keyframes dotPulse{0%,100%{opacity:1}50%{opacity:0.4}}
        .sb-lang{display:flex;align-items:center;gap:8px;padding:9px 12px;border-radius:var(--radius-sm);cursor:pointer;font-size:12px;color:var(--text-muted);transition:all .15s}
        .sb-lang:hover{background:var(--bg-raised);color:var(--text-secondary)}

        /* Main */
        .main{padding:24px 28px 80px;position:relative;min-height:100vh}
        html[dir="rtl"] .main{margin-right:var(--sidebar-w)}
        html[dir="ltr"] .main{margin-left:var(--sidebar-w)}

        /* Page Header */
        .page-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:28px}
        .page-title{font-size:22px;font-weight:700;letter-spacing:-0.02em}
        .page-subtitle{font-size:13px;color:var(--text-muted);margin-top:2px}

        /* Settings Grid */
        .settings-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(380px,1fr));gap:16px;max-width:1000px}

        /* Cards */
        .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius-lg);padding:20px;transition:all .2s}
        .card:hover{border-color:var(--border-hover)}
        .card-header{display:flex;align-items:center;gap:12px;margin-bottom:20px}
        .card-icon{width:40px;height:40px;border-radius:var(--radius-sm);display:flex;align-items:center;justify-content:center}
        .card-icon svg{width:20px;height:20px}
        .card-icon.green{background:var(--primary-muted);color:var(--primary)}
        .card-icon.blue{background:rgba(59,130,246,0.15);color:#3B82F6}
        .card-icon.purple{background:var(--secondary-muted);color:var(--secondary)}
        .card-icon.orange{background:rgba(245,158,11,0.15);color:var(--warning)}
        .card-title{font-size:15px;font-weight:600}
        .card-desc{font-size:12px;color:var(--text-muted);margin-top:2px}

        /* Channel Items */
        .channel-list{display:flex;flex-direction:column;gap:8px}
        .channel-item{display:flex;justify-content:space-between;align-items:center;padding:12px 14px;background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);transition:all .15s}
        .channel-item:hover{border-color:var(--border-hover)}
        .channel-info{display:flex;align-items:center;gap:12px}
        .channel-icon{width:36px;height:36px;border-radius:var(--radius-sm);display:flex;align-items:center;justify-content:center}
        .channel-icon svg{width:18px;height:18px}
        .channel-icon.whatsapp{background:rgba(37,211,102,0.15);color:#25D366}
        .channel-icon.email{background:rgba(234,67,53,0.15);color:#EA4335}
        .channel-icon.sms{background:rgba(59,130,246,0.15);color:#3B82F6}
        .channel-icon.telegram{background:rgba(34,158,217,0.15);color:#229ED9}
        .channel-name{font-size:13px;font-weight:600}
        .channel-desc{font-size:11px;color:var(--text-muted)}

        /* Toggle Switch */
        .toggle-switch{position:relative;width:44px;height:24px;cursor:pointer;flex-shrink:0}
        .toggle-switch input{opacity:0;width:0;height:0}
        .toggle-slider{position:absolute;inset:0;background:var(--border-hover);border-radius:24px;transition:all .2s}
        .toggle-slider::before{content:'';position:absolute;width:18px;height:18px;right:3px;top:3px;background:white;border-radius:50%;transition:all .2s}
        html[dir="ltr"] .toggle-slider::before{right:auto;left:3px}
        .toggle-switch input:checked+.toggle-slider{background:var(--primary)}
        .toggle-switch input:checked+.toggle-slider::before{transform:translateX(-20px)}
        html[dir="ltr"] .toggle-switch input:checked+.toggle-slider::before{transform:translateX(20px)}

        /* Usage Bar */
        .usage-section{margin-top:16px;padding-top:16px;border-top:1px solid var(--border)}
        .usage-header{display:flex;justify-content:space-between;margin-bottom:8px}
        .usage-label{font-size:12px;color:var(--text-muted)}
        .usage-value{font-size:12px;font-weight:600;color:var(--primary)}
        .usage-bar{height:6px;background:var(--bg-raised);border-radius:6px;overflow:hidden}
        .usage-fill{height:100%;background:linear-gradient(90deg,var(--primary),var(--primary-hover));border-radius:6px;transition:width .5s}

        /* Form */
        .form-group{margin-bottom:16px}
        .form-label{display:block;font-size:12px;font-weight:500;color:var(--text-secondary);margin-bottom:6px}
        .form-input{width:100%;padding:10px 14px;background:var(--bg);border:1px solid var(--border);border-radius:var(--radius-sm);color:var(--text);font-size:13px;font-family:inherit;transition:border-color .15s}
        .form-input:focus{outline:none;border-color:var(--primary)}

        /* Timing Grid */
        .timing-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
        .timing-item{padding:14px;background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);text-align:center}
        .timing-label{font-size:11px;color:var(--text-muted);margin-bottom:6px}
        .timing-value{font-size:20px;font-weight:700}
        .timing-unit{font-size:11px;color:var(--text-muted)}

        /* Buttons */
        .btn{display:inline-flex;align-items:center;gap:6px;padding:8px 16px;border-radius:var(--radius-sm);font-size:13px;font-weight:500;cursor:pointer;transition:all .15s;font-family:inherit;border:none;text-decoration:none}
        .btn-primary{background:var(--primary);color:white}
        .btn-primary:hover{background:var(--primary-hover)}
        .btn-outline{background:transparent;border:1px solid var(--border);color:var(--text-secondary)}
        .btn-outline:hover{background:var(--bg-raised);border-color:var(--border-hover);color:var(--text)}
        .btn svg{width:16px;height:16px}

        /* Upgrade Banner */
        .upgrade-banner{background:linear-gradient(135deg,rgba(16,185,129,0.1),rgba(99,102,241,0.1));border:1px solid rgba(16,185,129,0.2);border-radius:var(--radius-lg);padding:20px;display:flex;align-items:center;justify-content:space-between;gap:16px;margin-top:24px;max-width:1000px}
        .upgrade-title{font-size:15px;font-weight:600;margin-bottom:2px}
        .upgrade-desc{font-size:12px;color:var(--text-secondary)}

        /* Mobile Nav */
        .mob-nav{display:none;position:fixed;bottom:0;left:0;right:0;background:var(--bg);border-top:1px solid var(--border);z-index:200;padding:6px 0 env(safe-area-inset-bottom,8px)}
        .mob-nav-inner{display:flex;justify-content:space-around}
        .mn{display:flex;flex-direction:column;align-items:center;gap:2px;padding:6px 12px;color:var(--text-muted);cursor:pointer;transition:color .15s;text-decoration:none;font-size:10px;font-weight:500}
        .mn.active{color:var(--primary)}
        .mn svg{width:20px;height:20px}
        .mn.active svg{color:var(--primary)}

        /* Responsive */
        @media(max-width:1024px){
            .settings-grid{grid-template-columns:1fr}
        }
        @media(max-width:768px){
            .sidebar{display:none}
            .main{margin-right:0!important;margin-left:0!important;padding:16px 16px 80px;overflow-x:hidden}
            .page-title{font-size:18px}
            .settings-grid{grid-template-columns:1fr}
            .timing-grid{grid-template-columns:repeat(3,1fr)}
            .mob-nav{display:block}
            .upgrade-banner{flex-direction:column;text-align:center}
        }

        ::-webkit-scrollbar{width:5px}
        ::-webkit-scrollbar-track{background:transparent}
        ::-webkit-scrollbar-thumb{background:var(--border);border-radius:5px}

        .fade-in{animation:fadeIn .3s ease-out forwards}
        @keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
        .d1{animation-delay:.05s}.d2{animation-delay:.1s}
    </style>
</head>
<body>
    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="sb-logo">
            <div class="sb-logo-mark"><i data-lucide="zap" style="width:18px;height:18px;color:white"></i></div>
            <span class="sb-logo-text" data-ar="رِبح" data-en="RIBH">رِبح</span>
        </div>
        <div class="sb-section">
            <div class="sb-section-label" data-ar="الرئيسية" data-en="GENERAL">الرئيسية</div>
            <a class="sb-item" href="/app.html"><i data-lucide="layout-dashboard"></i><span data-ar="لوحة التحكم" data-en="Dashboard">لوحة التحكم</span></a>
            <a class="sb-item" href="/app.html#campaigns"><i data-lucide="megaphone"></i><span data-ar="الحملات" data-en="Campaigns">الحملات</span></a>
            <a class="sb-item" href="/app.html#customers"><i data-lucide="users"></i><span data-ar="العملاء" data-en="Customers">العملاء</span></a>
        </div>
        <div class="sb-section">
            <div class="sb-section-label" data-ar="الأدوات" data-en="TOOLS">الأدوات</div>
            <a class="sb-item" href="/app.html#cod"><i data-lucide="package-check"></i><span data-ar="تأكيد الطلبات" data-en="COD Confirm">تأكيد الطلبات</span></a>
            <a class="sb-item" href="/app.html#reviews"><i data-lucide="star"></i><span data-ar="التقييمات" data-en="Reviews">التقييمات</span></a>
            <a class="sb-item" href="/app.html#loyalty"><i data-lucide="trophy"></i><span data-ar="الولاء" data-en="Loyalty">الولاء</span></a>
        </div>
        <div class="sb-section">
            <div class="sb-section-label" data-ar="الدعم" data-en="SUPPORT">الدعم</div>
            <a class="sb-item active" href="/settings.html"><i data-lucide="settings"></i><span data-ar="الإعدادات" data-en="Settings">الإعدادات</span></a>
        </div>
        <div class="sb-spacer"></div>
        <div class="sb-status"><span class="sb-dot pulse"></span><span data-ar="واتساب متصل" data-en="WhatsApp connected">واتساب متصل</span></div>
        <div class="sb-lang" onclick="toggleLang()"><i data-lucide="globe" style="width:14px;height:14px"></i><span id="langLabel">English</span></div>
    </aside>

    <!-- Main -->
    <main class="main">
        <div class="page-header fade-in">
            <div>
                <div class="page-title" data-ar="الإعدادات" data-en="Settings">الإعدادات</div>
                <div class="page-subtitle" data-ar="إدارة قنوات التواصل وإعدادات الاسترداد" data-en="Manage channels and recovery settings">إدارة قنوات التواصل وإعدادات الاسترداد</div>
            </div>
        </div>

        <div class="settings-grid fade-in d1">
            <!-- Channels Card -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon green"><i data-lucide="radio"></i></div>
                    <div>
                        <div class="card-title" data-ar="قنوات التواصل" data-en="Channels">قنوات التواصل</div>
                        <div class="card-desc" data-ar="فعّل القنوات التي تريد استخدامها" data-en="Enable channels you want to use">فعّل القنوات التي تريد استخدامها</div>
                    </div>
                </div>
                <div class="channel-list">
                    <div class="channel-item">
                        <div class="channel-info">
                            <div class="channel-icon whatsapp"><i data-lucide="message-circle"></i></div>
                            <div><div class="channel-name">WhatsApp</div><div class="channel-desc" data-ar="98% معدل فتح" data-en="98% open rate">98% معدل فتح</div></div>
                        </div>
                        <label class="toggle-switch"><input type="checkbox" id="channelWhatsapp" checked><span class="toggle-slider"></span></label>
                    </div>
                    <div class="channel-item">
                        <div class="channel-info">
                            <div class="channel-icon email"><i data-lucide="mail"></i></div>
                            <div><div class="channel-name" data-ar="البريد الإلكتروني" data-en="Email">البريد الإلكتروني</div><div class="channel-desc" data-ar="مجاني - 500 رسالة/شهر" data-en="Free - 500/month">مجاني - 500 رسالة/شهر</div></div>
                        </div>
                        <label class="toggle-switch"><input type="checkbox" id="channelEmail" checked><span class="toggle-slider"></span></label>
                    </div>
                    <div class="channel-item">
                        <div class="channel-info">
                            <div class="channel-icon sms"><i data-lucide="smartphone"></i></div>
                            <div><div class="channel-name">SMS</div><div class="channel-desc" data-ar="0.08 ر.س/رسالة" data-en="$0.02/message">0.08 ر.س/رسالة</div></div>
                        </div>
                        <label class="toggle-switch"><input type="checkbox" id="channelSms"><span class="toggle-slider"></span></label>
                    </div>
                    <div class="channel-item">
                        <div class="channel-info">
                            <div class="channel-icon telegram"><i data-lucide="send"></i></div>
                            <div><div class="channel-name">Telegram</div><div class="channel-desc" data-ar="إشعارات لك أنت" data-en="Notifications for you">إشعارات لك أنت</div></div>
                        </div>
                        <label class="toggle-switch"><input type="checkbox" id="channelTelegram" checked><span class="toggle-slider"></span></label>
                    </div>
                </div>
                <div class="usage-section">
                    <div class="usage-header">
                        <span class="usage-label" data-ar="رصيد البريد الإلكتروني" data-en="Email Balance">رصيد البريد الإلكتروني</span>
                        <span class="usage-value" id="usageValue">344/500</span>
                    </div>
                    <div class="usage-bar"><div class="usage-fill" id="usageBar" style="width:31%"></div></div>
                </div>
            </div>

            <!-- Timing Card -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon orange"><i data-lucide="clock"></i></div>
                    <div>
                        <div class="card-title" data-ar="توقيت الرسائل" data-en="Message Timing">توقيت الرسائل</div>
                        <div class="card-desc" data-ar="متى نُرسل رسائل الاسترداد" data-en="When to send recovery messages">متى نُرسل رسائل الاسترداد</div>
                    </div>
                </div>
                <div class="timing-grid">
                    <div class="timing-item">
                        <div class="timing-label" data-ar="الرسالة الأولى" data-en="1st Message">الرسالة الأولى</div>
                        <div class="timing-value">30</div>
                        <div class="timing-unit" data-ar="دقيقة" data-en="minutes">دقيقة</div>
                    </div>
                    <div class="timing-item">
                        <div class="timing-label" data-ar="الرسالة الثانية" data-en="2nd Message">الرسالة الثانية</div>
                        <div class="timing-value">4</div>
                        <div class="timing-unit" data-ar="ساعات" data-en="hours">ساعات</div>
                    </div>
                    <div class="timing-item">
                        <div class="timing-label" data-ar="الرسالة الثالثة" data-en="3rd Message">الرسالة الثالثة</div>
                        <div class="timing-value">24</div>
                        <div class="timing-unit" data-ar="ساعة" data-en="hours">ساعة</div>
                    </div>
                </div>
                <p style="margin-top:14px;font-size:12px;color:var(--text-muted);display:flex;align-items:center;gap:6px">
                    <i data-lucide="lightbulb" style="width:14px;height:14px;color:var(--warning);flex-shrink:0"></i>
                    <span data-ar="التوقيت المثالي مبني على تحليل آلاف عمليات الاسترداد الناجحة" data-en="Optimal timing based on analysis of thousands of successful recoveries">التوقيت المثالي مبني على تحليل آلاف عمليات الاسترداد الناجحة</span>
                </p>
            </div>

            <!-- Store Info Card -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon blue"><i data-lucide="store"></i></div>
                    <div>
                        <div class="card-title" data-ar="معلومات المتجر" data-en="Store Info">معلومات المتجر</div>
                        <div class="card-desc" data-ar="تُستخدم في رسائل العملاء" data-en="Used in customer messages">تُستخدم في رسائل العملاء</div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label" data-ar="اسم المتجر" data-en="Store Name">اسم المتجر</label>
                    <input type="text" class="form-input" id="storeName" placeholder="متجر الأناقة">
                </div>
                <div class="form-group">
                    <label class="form-label" data-ar="بريد إلكتروني للرد" data-en="Reply-to Email">بريد إلكتروني للرد</label>
                    <input type="email" class="form-input" id="replyEmail" placeholder="support@yourstore.com">
                </div>
                <button class="btn btn-primary" onclick="saveSettings()" style="width:100%;justify-content:center;margin-top:4px">
                    <i data-lucide="save"></i>
                    <span data-ar="حفظ الإعدادات" data-en="Save Settings">حفظ الإعدادات</span>
                </button>
            </div>

            <!-- Protection Card -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon purple"><i data-lucide="shield-check"></i></div>
                    <div>
                        <div class="card-title" data-ar="الحماية التلقائية" data-en="Auto Protection">الحماية التلقائية</div>
                        <div class="card-desc" data-ar="نحمي سمعة متجرك تلقائياً" data-en="We protect your store reputation automatically">نحمي سمعة متجرك تلقائياً</div>
                    </div>
                </div>
                <div class="channel-list">
                    <div class="channel-item">
                        <div class="channel-info">
                            <div><div class="channel-name" data-ar="حارس السمعة" data-en="Reputation Guard">حارس السمعة</div><div class="channel-desc" data-ar="إيقاف تلقائي عند ارتفاع الحظر" data-en="Auto-pause on high block rates">إيقاف تلقائي عند ارتفاع الحظر</div></div>
                        </div>
                        <label class="toggle-switch"><input type="checkbox" checked disabled><span class="toggle-slider"></span></label>
                    </div>
                    <div class="channel-item">
                        <div class="channel-info">
                            <div><div class="channel-name" data-ar="معاينة الرسائل" data-en="Message Preview">معاينة الرسائل</div><div class="channel-desc" data-ar="لا شيء يُرسل بدون موافقتك" data-en="Nothing sent without your approval">لا شيء يُرسل بدون موافقتك</div></div>
                        </div>
                        <label class="toggle-switch"><input type="checkbox" checked disabled><span class="toggle-slider"></span></label>
                    </div>
                </div>
                <p style="margin-top:14px;font-size:12px;color:var(--success);display:flex;align-items:center;gap:6px">
                    <i data-lucide="check-circle" style="width:14px;height:14px;flex-shrink:0"></i>
                    <span data-ar="هذه الميزات مفعّلة دائماً لحماية متجرك" data-en="These features are always ON to protect your store">هذه الميزات مفعّلة دائماً لحماية متجرك</span>
                </p>
            </div>
        </div>

        <!-- Upgrade Banner -->
        <div class="upgrade-banner fade-in d2">
            <div>
                <div class="upgrade-title" data-ar="ترقية إلى Pro" data-en="Upgrade to Pro">ترقية إلى Pro</div>
                <div class="upgrade-desc" data-ar="رسائل غير محدودة + SMS + واتساب + تقارير متقدمة" data-en="Unlimited messages + SMS + WhatsApp + Advanced reports">رسائل غير محدودة + SMS + واتساب + تقارير متقدمة</div>
            </div>
            <button class="btn btn-primary" onclick="showUpgrade()">
                <i data-lucide="rocket"></i>
                <span data-ar="999 ر.س/سنة" data-en="$299/year">999 ر.س/سنة</span>
            </button>
        </div>
    </main>

    <!-- Mobile Nav -->
    <nav class="mob-nav"><div class="mob-nav-inner">
        <a class="mn" href="/app.html"><i data-lucide="layout-dashboard"></i><span data-ar="الرئيسية" data-en="Home">الرئيسية</span></a>
        <a class="mn" href="/app.html#campaigns"><i data-lucide="megaphone"></i><span data-ar="الحملات" data-en="Campaigns">الحملات</span></a>
        <a class="mn" href="/app.html#customers"><i data-lucide="users"></i><span data-ar="العملاء" data-en="Customers">العملاء</span></a>
        <a class="mn" href="/app.html#cod"><i data-lucide="package-check"></i><span data-ar="الطلبات" data-en="COD">الطلبات</span></a>
        <a class="mn active" href="/settings.html"><i data-lucide="settings"></i><span data-ar="إعدادات" data-en="Settings">إعدادات</span></a>
    </div></nav>

    <script>
    let lang=localStorage.getItem('ribhLang')||'ar';

    function toggleLang(){lang=lang==='ar'?'en':'ar';localStorage.setItem('ribhLang',lang);applyLang();}
    function applyLang(){const r=document.documentElement;r.setAttribute('dir',lang==='ar'?'rtl':'ltr');r.setAttribute('lang',lang);document.getElementById('langLabel').textContent=lang==='ar'?'English':'العربية';document.querySelectorAll('[data-ar]').forEach(el=>{el.textContent=el.getAttribute('data-'+lang)||el.textContent;});}

    async function loadSettings(){try{const res=await fetch('/api/store/settings');const data=await res.json();if(data.storeName)document.getElementById('storeName').value=data.storeName;if(data.replyEmail)document.getElementById('replyEmail').value=data.replyEmail;if(data.channels){document.getElementById('channelWhatsapp').checked=data.channels.whatsapp;document.getElementById('channelEmail').checked=data.channels.email;document.getElementById('channelSms').checked=data.channels.sms;document.getElementById('channelTelegram').checked=data.channels.telegram;}}catch(e){}}

    async function loadUsage(){try{const res=await fetch('/api/store/usage');const data=await res.json();const remaining=data.limit-data.emailsSent;const pct=Math.min(100,(data.emailsSent/data.limit)*100);document.getElementById('usageBar').style.width=pct+'%';document.getElementById('usageValue').textContent=remaining+'/'+data.limit;}catch(e){}}

    async function saveSettings(){const settings={storeName:document.getElementById('storeName').value,replyEmail:document.getElementById('replyEmail').value,channels:{whatsapp:document.getElementById('channelWhatsapp').checked,email:document.getElementById('channelEmail').checked,sms:document.getElementById('channelSms').checked,telegram:document.getElementById('channelTelegram').checked}};try{const res=await fetch('/api/store/settings',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(settings)});if(res.ok)alert(lang==='ar'?'تم حفظ الإعدادات بنجاح':'Settings saved successfully');}catch(e){alert(lang==='ar'?'حدث خطأ، حاول مرة أخرى':'Error, please try again');}}

    function showUpgrade(){alert(lang==='ar'?'للترقية تواصل معنا:\n\nWhatsApp: +966XXXXXXXXX\nEmail: support@ribh.click':'To upgrade, contact us:\n\nWhatsApp: +966XXXXXXXXX\nEmail: support@ribh.click');}

    document.addEventListener('DOMContentLoaded',()=>{lucide.createIcons();applyLang();loadSettings();loadUsage();});
    </script>
</body>
</html>

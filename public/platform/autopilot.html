<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RIBH â€” Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</title>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/platform/shared/shell.css">
    <style>
        .phase{display:none;animation:fadeUp .5s var(--ease)}.phase.active{display:block}
        @keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}

        /* Data Source Cards */
        .ds-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px;margin:32px 0}
        .ds-card{background:var(--bg-surface);border:1px solid var(--border);border-radius:var(--radius-lg);padding:28px 20px;text-align:center;cursor:pointer;transition:all .2s var(--ease);position:relative}
        .ds-card:hover{border-color:var(--border-strong);transform:translateY(-2px)}
        .ds-card.selected{border-color:var(--primary);box-shadow:0 0 24px var(--primary-glow)}
        .ds-card.disabled{opacity:.45;cursor:not-allowed;pointer-events:none}
        .ds-card-icon{font-size:40px;margin-bottom:12px}
        .ds-card-title{font-size:16px;font-weight:700;margin-bottom:4px}
        .ds-card-desc{font-size:12px;color:var(--text-muted)}
        .ds-card .coming{position:absolute;top:12px;left:12px;background:var(--bg-surface-2);border:1px solid var(--border);border-radius:20px;padding:2px 10px;font-size:10px;color:var(--text-dim)}
        .ds-card .connected-badge{position:absolute;top:12px;left:12px;background:var(--primary-dim);border-radius:20px;padding:2px 10px;font-size:10px;color:var(--primary);font-weight:600}

        /* Upload Zone */
        .upload-zone{border:2px dashed var(--border);border-radius:var(--radius-lg);padding:40px 20px;text-align:center;margin:20px 0;transition:all .2s;cursor:pointer;display:none}
        .upload-zone.show{display:block}
        .upload-zone:hover,.upload-zone.dragover{border-color:var(--primary);background:var(--primary-dim)}
        .upload-zone-icon{font-size:36px;margin-bottom:12px}
        .upload-zone-text{font-size:14px;color:var(--text-secondary)}
        .upload-zone-hint{font-size:11px;color:var(--text-dim);margin-top:8px}
        .upload-result{display:none;text-align:center;padding:20px;animation:fadeUp .3s}
        .upload-result.show{display:block}

        /* Hero */
        .hero-center{text-align:center;padding:48px 20px}
        .hero-icon{width:80px;height:80px;border-radius:24px;background:var(--primary-dim);display:flex;align-items:center;justify-content:center;margin:0 auto 24px;font-size:36px}
        .hero-title{font-size:26px;font-weight:800;margin-bottom:10px}
        .hero-sub{color:var(--text-muted);font-size:14px;margin-bottom:32px;max-width:500px;margin-left:auto;margin-right:auto}
        .hero-btn{display:inline-flex;align-items:center;gap:10px;padding:16px 44px;background:var(--primary);color:#000;border:none;border-radius:14px;font-size:17px;font-weight:700;cursor:pointer;font-family:inherit;transition:all .2s var(--ease);box-shadow:0 0 40px var(--primary-glow)}
        .hero-btn:hover{background:var(--primary-hover);transform:translateY(-2px);box-shadow:0 0 60px var(--primary-glow)}
        .hero-btn:disabled{opacity:.4;cursor:not-allowed;transform:none}

        /* Scan */
        .scan-center{text-align:center;padding:48px 20px}
        .scan-ring{width:100px;height:100px;border-radius:50%;border:3px solid var(--border);border-top-color:var(--primary);animation:spin 1s linear infinite;margin:0 auto 28px;display:flex;align-items:center;justify-content:center;font-size:28px}
        @keyframes spin{to{transform:rotate(360deg)}}
        .scan-title{font-size:18px;font-weight:700;margin-bottom:20px}
        .scan-steps{max-width:380px;margin:0 auto;text-align:right}
        .scan-step{display:flex;align-items:center;gap:10px;padding:8px 0;color:var(--text-dim);font-size:13px;transition:all .3s}
        .scan-step.done{color:var(--primary)}
        .scan-step.active{color:var(--text)}
        .step-dot{width:22px;height:22px;border-radius:50%;background:var(--bg-surface-2);display:flex;align-items:center;justify-content:center;font-size:11px;flex-shrink:0}
        .scan-step.done .step-dot{background:var(--primary-dim);color:var(--primary)}
        .scan-step.active .step-dot{background:var(--primary);color:#000;animation:pulse 1.5s infinite}
        @keyframes pulse{0%,100%{box-shadow:0 0 0 0 var(--primary-glow)}50%{box-shadow:0 0 0 8px transparent}}

        /* Results */
        .res-header{text-align:center;padding:24px 20px 20px}
        .res-rev{font-size:38px;font-weight:800;color:var(--primary);direction:ltr;display:inline-block}
        .res-rev-label{font-size:13px;color:var(--text-muted);margin-bottom:6px}
        .res-rev-range{font-size:12px;color:var(--text-dim);margin-top:4px}
        .stats-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(130px,1fr));gap:10px;margin-bottom:20px}
        .m-stat{background:var(--bg-surface);border:1px solid var(--border);border-radius:var(--radius-md);padding:14px;text-align:center}
        .m-stat-val{font-size:20px;font-weight:800;direction:ltr;display:inline-block}
        .m-stat-lbl{font-size:10px;color:var(--text-muted);margin-top:3px}

        /* Campaign Cards */
        .camp{background:var(--bg-surface);border:1px solid var(--border);border-radius:var(--radius-lg);padding:18px;margin-bottom:10px;transition:border-color .2s}
        .camp:hover{border-color:var(--border-strong)}
        .camp-top{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;flex-wrap:wrap;gap:8px}
        .camp-title-row{display:flex;align-items:center;gap:10px}
        .camp-ico{width:36px;height:36px;border-radius:9px;display:flex;align-items:center;justify-content:center;font-size:16px;flex-shrink:0}
        .camp-name{font-size:14px;font-weight:700}
        .camp-desc{font-size:11px;color:var(--text-muted)}
        .camp-stats{display:flex;gap:16px;flex-wrap:wrap;font-size:12px;color:var(--text-secondary)}
        .camp-stats strong{color:var(--text);font-weight:700}
        .camp-actions{display:flex;gap:6px;margin-top:12px;padding-top:12px;border-top:1px solid var(--border)}
        .msg-prev{background:var(--bg-surface-2);border-radius:var(--radius-sm);padding:12px;margin-top:10px;font-size:12px;line-height:1.9;color:var(--text-secondary);border-right:3px solid var(--whatsapp);display:none}
        .msg-prev.show{display:block;animation:fadeUp .3s}
        .msg-prev-lbl{font-size:10px;color:var(--text-dim);margin-bottom:6px;display:flex;align-items:center;gap:5px}

        /* Buttons */
        .btn{display:inline-flex;align-items:center;gap:6px;padding:7px 14px;border-radius:var(--radius-sm);font-size:12px;font-weight:600;border:none;cursor:pointer;font-family:inherit;transition:all .15s var(--ease)}
        .btn-primary{background:var(--primary);color:#000}.btn-primary:hover{background:var(--primary-hover)}
        .btn-secondary{background:var(--bg-surface-2);color:var(--text-secondary);border:1px solid var(--border)}.btn-secondary:hover{border-color:var(--border-strong);color:var(--text)}
        .btn-ghost{background:transparent;color:var(--text-muted)}.btn-ghost:hover{color:var(--text);background:var(--bg-hover)}
        .btn-danger{background:var(--danger-dim);color:var(--danger)}
        .btn-lg{padding:14px 36px;font-size:16px;font-weight:700;border-radius:14px}
        .badge{display:inline-flex;align-items:center;gap:4px;padding:3px 10px;border-radius:20px;font-size:10px;font-weight:600}
        .badge-primary{background:var(--primary-dim);color:var(--primary)}
        .badge-danger{background:var(--danger-dim);color:var(--danger)}
        .badge-success{background:var(--success-dim);color:var(--success)}
        .badge-warning{background:var(--warning-dim);color:var(--warning)}
        .badge-info{background:var(--info-dim);color:var(--info)}
        .badge-whatsapp{background:var(--whatsapp-dim);color:var(--whatsapp)}
        .badge-neutral{background:var(--bg-surface-2);color:var(--text-dim)}
        .sec-title{font-size:15px;font-weight:700;margin-bottom:14px}

        /* Modal */
        .modal-bg{position:fixed;inset:0;background:rgba(0,0,0,.7);backdrop-filter:blur(4px);z-index:500;display:none;align-items:center;justify-content:center}
        .modal-bg.open{display:flex}
        .modal{background:var(--bg-surface);border:1px solid var(--border);border-radius:var(--radius-xl);width:90%;max-width:540px;max-height:80vh;overflow-y:auto;padding:24px;animation:modalIn .3s var(--ease)}
        @keyframes modalIn{from{opacity:0;transform:scale(.96) translateY(10px)}to{opacity:1;transform:scale(1) translateY(0)}}
        .modal-title{font-size:16px;font-weight:700;margin-bottom:16px}
        .modal textarea{width:100%;min-height:140px;background:var(--bg-surface-2);border:1px solid var(--border);border-radius:var(--radius-sm);padding:12px;color:var(--text);font-family:inherit;font-size:13px;line-height:1.8;resize:vertical;direction:rtl}
        .modal textarea:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 3px var(--primary-dim)}
        .modal-hint{font-size:10px;color:var(--text-dim);margin:6px 0 16px}
        .modal-btns{display:flex;gap:8px}
        .type-btns,.seg-btns{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:14px}
        .type-btn,.seg-btn{padding:6px 12px;border-radius:var(--radius-sm);font-size:11px;font-weight:600;border:1px solid var(--border);background:var(--bg-surface-2);color:var(--text-muted);cursor:pointer;font-family:inherit;transition:all .15s}
        .type-btn.active,.seg-btn.active{border-color:var(--primary);color:var(--primary);background:var(--primary-dim)}

        /* Live */
        .live-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;flex-wrap:wrap;gap:10px}
        .live-ind{display:flex;align-items:center;gap:8px;font-size:15px;font-weight:700}
        .live-dot{width:10px;height:10px;border-radius:50%;background:#EF4444;animation:livePulse 1.5s infinite}
        @keyframes livePulse{0%,100%{opacity:1}50%{opacity:.4}}
        .live-rev{text-align:center;padding:28px;background:var(--bg-surface);border:1px solid var(--border);border-radius:var(--radius-xl);margin-bottom:16px}
        .live-rev-num{font-size:44px;font-weight:800;color:var(--primary);direction:ltr;display:inline-block}
        .live-rev-lbl{font-size:12px;color:var(--text-muted);margin-bottom:6px}
        .live-bar{height:7px;background:var(--bg-surface-2);border-radius:4px;margin-top:14px;overflow:hidden}
        .live-bar-fill{height:100%;background:linear-gradient(90deg,var(--primary),#22C55E);border-radius:4px;transition:width 1s var(--ease)}
        .live-bar-txt{font-size:11px;color:var(--text-dim);margin-top:5px;text-align:center}
        .live-camps{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:10px;margin-bottom:16px}
        .lc{background:var(--bg-surface);border:1px solid var(--border);border-radius:var(--radius-md);padding:14px}
        .lc-top{display:flex;align-items:center;gap:8px;margin-bottom:8px}
        .lc-ico{width:28px;height:28px;border-radius:7px;display:flex;align-items:center;justify-content:center;font-size:13px}
        .lc-name{font-size:12px;font-weight:600}
        .lc-val{font-size:15px;font-weight:700;direction:ltr;display:inline-block}
        .lc-sub{font-size:10px;color:var(--text-muted)}
        .ai-box{background:linear-gradient(135deg,rgba(16,185,129,.08),rgba(99,102,241,.06));border:1px solid rgba(16,185,129,.2);border-radius:var(--radius-lg);padding:14px 18px;font-size:12px;color:var(--text-secondary);line-height:1.7}
        .ai-box-lbl{font-size:10px;font-weight:700;color:var(--primary);margin-bottom:4px}
        .feed{background:var(--bg-surface);border:1px solid var(--border);border-radius:var(--radius-lg);overflow:hidden;margin-top:14px}
        .feed-title{padding:14px 18px;font-size:13px;font-weight:700;border-bottom:1px solid var(--border)}
        .feed-items{max-height:340px;overflow-y:auto}
        .fi{display:flex;align-items:center;gap:10px;padding:12px 18px;border-bottom:1px solid var(--border);font-size:12px;animation:feedIn .4s var(--ease)}
        @keyframes feedIn{from{opacity:0;transform:translateX(20px)}to{opacity:1;transform:translateX(0)}}
        .fi:last-child{border-bottom:none}
        .fi-ico{width:28px;height:28px;border-radius:7px;display:flex;align-items:center;justify-content:center;font-size:12px;flex-shrink:0}
        .fi-txt{flex:1;color:var(--text-secondary)}.fi-txt strong{color:var(--text);font-weight:600}
        .fi-time{font-size:10px;color:var(--text-dim);white-space:nowrap}
        .fi-amt{font-weight:700;color:var(--primary);direction:ltr;white-space:nowrap}

        /* Toast */
        .toast{position:fixed;bottom:24px;left:50%;transform:translateX(-50%);background:var(--bg-surface);border:1px solid var(--primary);color:var(--text);padding:10px 22px;border-radius:12px;font-size:13px;z-index:9999;box-shadow:0 8px 32px rgba(0,0,0,.5);animation:fadeUp .3s}

        @media(max-width:768px){
            .hero-title{font-size:20px}.hero-btn{padding:12px 28px;font-size:15px}
            .res-rev{font-size:30px}.live-rev-num{font-size:32px}
            .stats-row{grid-template-columns:repeat(2,1fr)}.live-camps{grid-template-columns:repeat(2,1fr)}
            .ds-grid{grid-template-columns:1fr}
        }
    </style>
</head>
<body>
<div id="app"><div id="page-body">

<!-- â•â•â• PHASE 0: DATA SOURCE â•â•â• -->
<div class="phase active" id="phase0">
    <div class="hero-center">
        <div class="hero-icon">ğŸ“Š</div>
        <h1 class="hero-title">ÙˆØµÙ‘Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù…Ù„Ø§Ø¦Ùƒ</h1>
        <p class="hero-sub">Ø§Ø®ØªØ± Ù…ØµØ¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª â€” Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ÙŠØ­Ù„Ù„ ÙˆÙŠØ¬Ù‡Ù‘Ø² ÙƒÙ„ Ø´ÙŠ</p>
    </div>
    <div class="ds-grid">
        <div class="ds-card" onclick="selectSource('salla')" id="dsSalla">
            <div class="connected-badge" style="display:none" id="sallaConnected">Ù…ØªØµÙ„ âœ“</div>
            <div class="ds-card-icon">ğŸ›ï¸</div>
            <div class="ds-card-title">Ø³Ù„Ø© (Salla)</div>
            <div class="ds-card-desc">Ø±Ø¨Ø· ØªÙ„Ù‚Ø§Ø¦ÙŠ â€” Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙˆØ§Ù„Ø³Ù„Ø§Øª ÙˆØ§Ù„Ø¹Ù…Ù„Ø§Ø¡</div>
        </div>
        <div class="ds-card" onclick="selectSource('excel')" id="dsExcel">
            <div class="ds-card-icon">ğŸ“</div>
            <div class="ds-card-title">Ù…Ù„Ù Ø¥ÙƒØ³Ù„ / CSV</div>
            <div class="ds-card-desc">Ø§Ø±ÙØ¹ Ù…Ù„Ù Ø¹Ù…Ù„Ø§Ø¦Ùƒ â€” Ø§Ù„Ø§Ø³Ù…ØŒ Ø§Ù„Ø¬ÙˆØ§Ù„ØŒ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</div>
        </div>
        <div class="ds-card disabled" id="dsShopify">
            <div class="coming">Ù‚Ø±ÙŠØ¨Ø§Ù‹</div>
            <div class="ds-card-icon">ğŸŸ¢</div>
            <div class="ds-card-title">Shopify</div>
            <div class="ds-card-desc">Ø±Ø¨Ø· Ù…ØªØ¬Ø± Ø´ÙˆØ¨ÙŠÙØ§ÙŠ</div>
        </div>
    </div>

    <!-- Salla Connect -->
    <div id="sallaSection" style="display:none;text-align:center;padding:20px;">
        <div style="background:var(--bg-surface);border:1px solid var(--border);border-radius:var(--radius-lg);padding:24px;max-width:400px;margin:0 auto;">
            <div style="font-size:15px;font-weight:700;margin-bottom:12px;">Ø±Ø¨Ø· Ù…ØªØ¬Ø± Ø³Ù„Ø©</div>
            <p style="font-size:12px;color:var(--text-muted);margin-bottom:16px;">Ø£Ø¯Ø®Ù„ Ø±Ø§Ø¨Ø· Ù…ØªØ¬Ø±Ùƒ Ø£Ùˆ Ø§Ø¶ØºØ· Ø±Ø¨Ø· Ù„Ù„Ø§ØªØµØ§Ù„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</p>
            <button class="btn btn-primary btn-lg" onclick="connectSalla()" style="width:100%;">Ø±Ø¨Ø· Ø³Ù„Ø©</button>
            <p style="font-size:10px;color:var(--text-dim);margin-top:10px;">Ø£Ùˆ: Ø§Ù„Ù…ØªØ¬Ø± Ù…ØªØµÙ„ Ù…Ø³Ø¨Ù‚Ø§Ù‹ØŸ</p>
            <button class="btn btn-ghost" onclick="simulateSallaConnected()" style="margin-top:4px;">ØªØ®Ø·ÙŠ â€” Ù…ØªØ¬Ø±ÙŠ Ù…ØªØµÙ„</button>
        </div>
    </div>

    <!-- Excel Upload -->
    <div id="excelSection" style="display:none;max-width:500px;margin:0 auto;">
        <div class="upload-zone show" id="uploadZone" onclick="document.getElementById('fileInput').click()">
            <div class="upload-zone-icon">ğŸ“„</div>
            <div class="upload-zone-text">Ø§Ø³Ø­Ø¨ Ø§Ù„Ù…Ù„Ù Ù‡Ù†Ø§ Ø£Ùˆ Ø§Ø¶ØºØ· Ù„Ù„Ø§Ø®ØªÙŠØ§Ø±</div>
            <div class="upload-zone-hint">Excel (.xlsx) Ø£Ùˆ CSV â€” Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©: Ø§Ù„Ø§Ø³Ù…ØŒ Ø§Ù„Ø¬ÙˆØ§Ù„ØŒ Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§ØªØŒ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</div>
        </div>
        <input type="file" id="fileInput" accept=".csv,.xlsx,.xls" style="display:none" onchange="handleFileUpload(this)">
        <div class="upload-result" id="uploadResult">
            <div style="font-size:48px;margin-bottom:12px;">âœ…</div>
            <div style="font-size:16px;font-weight:700;margin-bottom:4px;" id="uploadCount">ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ 847 Ø¹Ù…ÙŠÙ„</div>
            <div style="font-size:12px;color:var(--text-muted);" id="uploadDetails">512 Ø¨Ø±Ù‚Ù… Ø¬ÙˆØ§Ù„ â€” 335 Ø¨Ø¥ÙŠÙ…ÙŠÙ„ ÙÙ‚Ø·</div>
        </div>
    </div>

    <div style="text-align:center;padding:20px;">
        <button class="hero-btn" id="proceedBtn" onclick="goToAnalyze()" disabled>
            Ù…ØªØ§Ø¨Ø¹Ø© â†
        </button>
    </div>
</div>

<!-- â•â•â• PHASE 1: ANALYZE BUTTON â•â•â• -->
<div class="phase" id="phase1">
    <div class="hero-center">
        <div class="hero-icon">ğŸ’°</div>
        <h1 class="hero-title">Ø­ÙˆÙ‘Ù„ Ø¹Ù…Ù„Ø§Ø¡Ùƒ Ø¥Ù„Ù‰ Ø£Ø±Ø¨Ø§Ø­</h1>
        <p class="hero-sub">Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ÙŠØ­Ù„Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ ÙˆÙŠÙˆÙ„Ù‘Ø¯ Ø­Ù…Ù„Ø§Øª Ø¬Ø§Ù‡Ø²Ø©<br>ÙˆØ§ØªØ³Ø§Ø¨ + Ø¥ÙŠÙ…ÙŠÙ„ + SMS â€” ÙƒÙ„ Ø´ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠ</p>
        <button class="hero-btn" onclick="startScan()">
            Ø­Ù„Ù„ ÙˆØ¬Ù‡Ù‘Ø² Ø§Ù„Ø­Ù…Ù„Ø§Øª â†
        </button>
        <div style="margin-top:16px;font-size:12px;color:var(--text-dim);" id="sourceLabel"></div>
    </div>
</div>

<!-- â•â•â• PHASE 2: SCANNING â•â•â• -->
<div class="phase" id="phase2">
    <div class="scan-center">
        <div class="scan-ring"><span>ğŸ”</span></div>
        <h2 class="scan-title">Ø¬Ø§Ø±ÙŠ ØªØ­Ù„ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ...</h2>
        <div class="scan-steps" id="scanSteps">
            <div class="scan-step" data-s="1"><div class="step-dot">Ù¡</div><span>Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙˆØ§Ù„Ø·Ù„Ø¨Ø§Øª</span></div>
            <div class="scan-step" data-s="2"><div class="step-dot">Ù¢</div><span>ØªØµÙ†ÙŠÙ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ (Champions, At-Risk, New...)</span></div>
            <div class="scan-step" data-s="3"><div class="step-dot">Ù£</div><span>ÙƒØ´Ù Ø§Ù„Ø³Ù„Ø§Øª Ø§Ù„Ù…ØªØ±ÙˆÙƒØ©</span></div>
            <div class="scan-step" data-s="4"><div class="step-dot">Ù¤</div><span>ØªØ­Ù„ÙŠÙ„ Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø´Ø±Ø§Ø¡</span></div>
            <div class="scan-step" data-s="5"><div class="step-dot">Ù¥</div><span>ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø­Ù…Ù„Ø§Øª ÙˆØ§Ù„Ø±Ø³Ø§Ø¦Ù„</span></div>
            <div class="scan-step" data-s="6"><div class="step-dot">Ù¦</div><span>Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©</span></div>
        </div>
    </div>
</div>

<!-- â•â•â• PHASE 3: RESULTS â•â•â• -->
<div class="phase" id="phase3">
    <div class="res-header">
        <div class="res-rev-label">Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø© Ø®Ù„Ø§Ù„ 7 Ø£ÙŠØ§Ù…</div>
        <div class="res-rev">12,400 Ø±.Ø³</div>
        <div class="res-rev-range">Ø§Ù„Ù…Ø¯Ù‰: 8,400 â€” 16,200 Ø±.Ø³ Ø­Ø³Ø¨ Ø§Ù„ØªÙØ§Ø¹Ù„</div>
    </div>
    <div class="stats-row">
        <div class="m-stat"><div class="m-stat-val" style="color:var(--primary)">847</div><div class="m-stat-lbl">Ø¹Ù…ÙŠÙ„ Ù…Ø³ØªÙ‡Ø¯Ù</div></div>
        <div class="m-stat"><div class="m-stat-val" style="color:var(--whatsapp)">312</div><div class="m-stat-lbl">ÙˆØ§ØªØ³Ø§Ø¨</div></div>
        <div class="m-stat"><div class="m-stat-val" style="color:var(--info)">420</div><div class="m-stat-lbl">Ø¥ÙŠÙ…ÙŠÙ„</div></div>
        <div class="m-stat"><div class="m-stat-val" style="color:var(--warning)">115</div><div class="m-stat-lbl">SMS</div></div>
        <div class="m-stat"><div class="m-stat-val" style="color:var(--secondary)">6</div><div class="m-stat-lbl">Ø­Ù…Ù„Ø©</div></div>
        <div class="m-stat"><div class="m-stat-val" style="color:var(--danger)">7</div><div class="m-stat-lbl">Ø£ÙŠØ§Ù…</div></div>
    </div>
    <div class="sec-title">Ø§Ù„Ø­Ù…Ù„Ø§Øª Ø§Ù„Ù…ÙˆÙ„Ù‘Ø¯Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</div>
    <div id="campaignsList"></div>
    <div style="padding:20px 0;display:flex;gap:10px;flex-wrap:wrap;align-items:center;">
        <button class="btn btn-primary btn-lg" onclick="goLive()" style="box-shadow:0 0 40px var(--primary-glow);">ğŸš€ Ø´ØºÙ‘Ù„ ÙƒÙ„ Ø§Ù„Ø­Ù…Ù„Ø§Øª</button>
        <button class="btn btn-secondary" onclick="openCustom()">â• Ø­Ù…Ù„Ø© Ù…Ø®ØµØµØ©</button>
        <label style="display:flex;align-items:center;gap:6px;font-size:11px;color:var(--text-muted);margin-right:auto;"><input type="checkbox" id="trustMode" style="accent-color:var(--primary)"> Ø§Ù„Ù…Ø±Ø© Ø§Ù„Ø¬Ø§ÙŠØ© Ø¨Ø¯ÙˆÙ† Ù…Ø¹Ø§ÙŠÙ†Ø©</label>
    </div>
</div>

<!-- â•â•â• PHASE 4: LIVE â•â•â• -->
<div class="phase" id="phase4">
    <div class="live-head">
        <div class="live-ind"><div class="live-dot"></div><span>Ø§Ù„Ø±Ø¨Ø­ Ø´ØºÙ‘Ø§Ù„</span></div>
        <div style="display:flex;gap:6px;flex-wrap:wrap;">
            <button class="btn btn-ghost" onclick="show('phase3')">âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„</button>
            <button class="btn btn-secondary" onclick="openCustom()">â• Ø­Ù…Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
            <button class="btn btn-danger" onclick="pauseAll()">â¸ï¸ Ø¥ÙŠÙ‚Ø§Ù</button>
        </div>
    </div>
    <div class="live-rev">
        <div class="live-rev-lbl">ØªÙ… ØªØ­ØµÙŠÙ„</div>
        <div class="live-rev-num" id="liveRev">0</div>
        <div style="font-size:12px;color:var(--text-muted);margin-top:2px">Ø±.Ø³</div>
        <div class="live-bar"><div class="live-bar-fill" id="liveBar" style="width:0%"></div></div>
        <div class="live-bar-txt" id="liveBarTxt">0% Ù…Ù† Ø§Ù„Ù‡Ø¯Ù (12,400 Ø±.Ø³)</div>
    </div>
    <div class="live-camps" id="liveCamps"></div>
    <div class="ai-box" id="aiBox"><div class="ai-box-lbl">ğŸ’¡ Ø°ÙƒØ§Ø¡ Ø§Ù„Ø±Ø¨Ø­</div>Ø¬Ø§Ø±ÙŠ ØªØ­Ù„ÙŠÙ„ Ø£ÙˆÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬...</div>
    <div class="feed" style="margin-top:14px">
        <div class="feed-title">Ø¢Ø®Ø± Ø§Ù„Ø£Ø­Ø¯Ø§Ø«</div>
        <div class="feed-items" id="feedItems"><div class="fi" style="justify-content:center;color:var(--text-dim);padding:32px;">Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø£ÙˆÙ„ Ø±Ø³Ø§Ù„Ø©...</div></div>
    </div>
</div>

</div></div>

<!-- â•â•â• EDIT MODAL â•â•â• -->
<div class="modal-bg" id="editModal" onclick="if(event.target===this)closeEdit()">
    <div class="modal">
        <div class="modal-title">âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©</div>
        <textarea id="editTA"></textarea>
        <div class="modal-hint">Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª: {Ø§Ù„Ø§Ø³Ù…} {Ø§Ù„Ù…Ù†ØªØ¬} {Ø±Ø§Ø¨Ø·_Ø§Ù„Ø³Ù„Ø©} {Ø§Ù„Ù†Ø³Ø¨Ø©} â€” ØªØªØ¹Ø¨Ø£ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù„ÙƒÙ„ Ø¹Ù…ÙŠÙ„</div>
        <div class="modal-btns">
            <button class="btn btn-primary" onclick="saveEdit()">Ø­ÙØ¸</button>
            <button class="btn btn-secondary" onclick="closeEdit()">Ø¥Ù„ØºØ§Ø¡</button>
            <button class="btn btn-ghost" onclick="aiRegenerate()" style="margin-right:auto">ğŸ¤– Ø§Ù‚ØªØ±Ø§Ø­ Ø¬Ø¯ÙŠØ¯</button>
        </div>
    </div>
</div>

<!-- â•â•â• CUSTOM CAMPAIGN MODAL â•â•â• -->
<div class="modal-bg" id="customModal" onclick="if(event.target===this)closeCustom()">
    <div class="modal">
        <div class="modal-title">â• Ø­Ù…Ù„Ø© Ù…Ø®ØµØµØ©</div>
        <div style="font-size:11px;color:var(--text-muted);margin-bottom:6px">Ù†ÙˆØ¹ Ø§Ù„Ø­Ù…Ù„Ø©</div>
        <div class="type-btns" id="typeBtns">
            <button class="type-btn active" data-t="promo">ğŸ·ï¸ Ø¹Ø±Ø¶ Ø®Ø§Øµ</button>
            <button class="type-btn" data-t="new_product">ğŸ†• Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯</button>
            <button class="type-btn" data-t="flash">âš¡ ÙÙ„Ø§Ø´ Ø³ÙŠÙ„</button>
            <button class="type-btn" data-t="seasonal">ğŸŒ™ Ù…ÙˆØ³Ù…ÙŠ</button>
            <button class="type-btn" data-t="restock">ğŸ“¦ Ø±Ø¬Ø¹ Ù„Ù„Ù…Ø®Ø²ÙˆÙ†</button>
            <button class="type-btn" data-t="loyalty">ğŸ‘‘ ÙˆÙ„Ø§Ø¡</button>
        </div>
        <div style="font-size:11px;color:var(--text-muted);margin-bottom:6px">Ù…Ù† ÙŠØ³ØªÙ„Ù…ØŸ</div>
        <div class="seg-btns" id="segBtns">
            <button class="seg-btn active" data-s="all">Ø§Ù„ÙƒÙ„ (847)</button>
            <button class="seg-btn" data-s="vip">Ø§Ù„Ù…Ù…ÙŠØ²ÙŠÙ† (45)</button>
            <button class="seg-btn" data-s="loyal">Ø§Ù„Ù…Ø®Ù„ØµÙŠÙ† (312)</button>
            <button class="seg-btn" data-s="atrisk">Ù…Ø¹Ø±Ø¶ÙŠÙ† Ù„Ù„Ø®Ø³Ø§Ø±Ø© (156)</button>
            <button class="seg-btn" data-s="new">Ø§Ù„Ø¬Ø¯Ø¯ (89)</button>
        </div>
        <div style="font-size:11px;color:var(--text-muted);margin-bottom:6px">Ø§Ù„Ø±Ø³Ø§Ù„Ø©</div>
        <textarea id="customTA" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ... Ø£Ùˆ Ø§Ø¶ØºØ· ÙˆÙ„Ù‘Ø¯ Ø±Ø³Ø§Ù„Ø© ğŸ‘‡"></textarea>
        <div style="margin-top:14px;display:flex;gap:8px;">
            <button class="btn btn-primary" onclick="launchCustom()">ğŸš€ Ø£Ø·Ù„Ù‚</button>
            <button class="btn btn-secondary" onclick="closeCustom()">Ø¥Ù„ØºØ§Ø¡</button>
            <button class="btn btn-ghost" onclick="aiCustom()" style="margin-right:auto">ğŸ¤– ÙˆÙ„Ù‘Ø¯ Ø±Ø³Ø§Ù„Ø©</button>
        </div>
    </div>
</div>

<script src="https://unpkg.com/lucide@latest"></script>
<script src="/platform/shared/shell.js"></script>
<script>
// â•â•â• INIT â•â•â•
RibhShell.init('autopilot');

// â•â•â• STATE â•â•â•
let selectedSource = null;
let editingCampIdx = null;
let liveRevenue = 0;
let feedIdx = 0;
let liveTimer = null;
let counters = {carts:0, winback:0, upsell:0, vip:0, browse:0, reviews:0};

// â•â•â• CAMPAIGNS DATA â•â•â•
const campaigns = [
    {id:'cart', icon:'ğŸ›’', iconBg:'var(--primary-dim)', name:'Ø§Ø³ØªØ±Ø¯Ø§Ø¯ Ø§Ù„Ø³Ù„Ø§Øª Ø§Ù„Ù…ØªØ±ÙˆÙƒØ©', desc:'23 Ø³Ù„Ø© Ù…ØªØ±ÙˆÙƒØ© â€” ØªØ°ÙƒÙŠØ± ÙÙˆØ±ÙŠ + Ù…ØªØ§Ø¨Ø¹Ø© ØªØµØ§Ø¹Ø¯ÙŠØ©', badge:'Ø£Ø¹Ù„Ù‰ Ø£ÙˆÙ„ÙˆÙŠØ©', badgeCls:'badge-primary',
     stats:{customers:23, channel:'ÙˆØ§ØªØ³Ø§Ø¨ â† Ø¥ÙŠÙ…ÙŠÙ„ â† SMS', discount:'0% â†’ 10% â†’ 15%', revenue:'3,200 Ø±.Ø³'},
     msg:'Ù…Ø±Ø­Ø¨Ø§ {Ø§Ù„Ø§Ø³Ù…}ØŒ Ù…Ø³Ø§Ø¡ Ø§Ù„Ø®ÙŠØ± ğŸŒ™\n{Ø§Ù„Ù…Ù†ØªØ¬} Ù„Ø³Ø§ Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø³Ù„ØªÙƒ\nØ¨Ø§Ù‚ÙŠ 3 Ø­Ø¨Ø§Øª Ø¨Ø³ â€” ÙŠÙ„Ø§ Ù‚Ø¨Ù„ Ù„Ø§ ÙŠØ®Ù„Øµ ğŸ”¥\nØ£ÙƒÙ…Ù„ Ø·Ù„Ø¨Ùƒ ğŸ‘‡\n{Ø±Ø§Ø¨Ø·_Ø§Ù„Ø³Ù„Ø©}', msgLabel:'ğŸ’¬ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ (Ø¨Ø¯ÙˆÙ† Ø®ØµÙ…):'},
    {id:'winback', icon:'ğŸ’¤', iconBg:'var(--danger-dim)', name:'Ø¥Ø¹Ø§Ø¯Ø© ØªÙ†Ø´ÙŠØ· Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡', desc:'156 Ø¹Ù…ÙŠÙ„ Ù…Ø¹Ø±Ø¶ Ù„Ù„Ø®Ø³Ø§Ø±Ø© â€” Ù„Ù… ÙŠØ´ØªØ±ÙˆØ§ Ù…Ù†Ø° 60+ ÙŠÙˆÙ…', badge:'Ø¹Ø§Ù„ÙŠ Ø§Ù„Ù‚ÙŠÙ…Ø©', badgeCls:'badge-danger',
     stats:{customers:156, channel:'ÙˆØ§ØªØ³Ø§Ø¨ â† Ø¥ÙŠÙ…ÙŠÙ„', discount:'15-20% Ø­Ø³Ø¨ CLV', revenue:'4,800 Ø±.Ø³'},
     msg:'ÙˆØ­Ø´ØªÙ†Ø§ {Ø§Ù„Ø§Ø³Ù…}! ğŸ‘‹\nØ¹Ù†Ø¯Ù†Ø§ Ø¬Ø¯ÙŠØ¯ ÙŠÙ†Ø§Ø³Ø¨Ùƒ â€” Ø®ØµÙ… {Ø§Ù„Ù†Ø³Ø¨Ø©}% Ù„Ø£Ù†Ùƒ Ù…Ù† Ø¹Ù…Ù„Ø§Ø¦Ù†Ø§ Ø§Ù„Ù…Ù…ÙŠØ²ÙŠÙ†\nØ´ÙˆÙ Ø§Ù„Ø¹Ø±Ø¶ ğŸ‘‡\n{Ø±Ø§Ø¨Ø·_Ø§Ù„Ù…ØªØ¬Ø±}', msgLabel:'ğŸ’¬ Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªÙ†Ø´ÙŠØ·:'},
    {id:'upsell', icon:'ğŸ', iconBg:'var(--secondary-dim)', name:'Ø¨ÙŠØ¹ Ø¥Ø¶Ø§ÙÙŠ Ø¨Ø¹Ø¯ Ø§Ù„Ø´Ø±Ø§Ø¡', desc:'89 Ø¹Ù…ÙŠÙ„ Ø§Ø´ØªØ±ÙˆØ§ Ù…Ø¤Ø®Ø±Ø§Ù‹ â€” Ù…Ù†ØªØ¬Ø§Øª Ù…ÙƒÙ…Ù„Ø©', badge:'Ù…Ø¬Ø§Ù†ÙŠ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨', badgeCls:'badge-success',
     stats:{customers:89, channel:'ÙˆØ§ØªØ³Ø§Ø¨ (Ù†Ø§ÙØ°Ø© Ù…Ø¬Ø§Ù†ÙŠØ©)', discount:'10%', revenue:'2,100 Ø±.Ø³'},
     msg:'Ù‡Ù„Ø§ {Ø§Ù„Ø§Ø³Ù…} ğŸ‘‹\nØ·Ù„Ø¨Ùƒ #{Ø±Ù‚Ù…_Ø§Ù„Ø·Ù„Ø¨} ÙÙŠ Ø§Ù„Ø·Ø±ÙŠÙ‚!\nØ¹Ù…Ù„Ø§Ø¡ Ù…Ø«Ù„Ùƒ Ø£Ø®Ø°ÙˆØ§ Ù…Ø¹Ø§Ù‡ {Ø§Ù„Ù…Ù†ØªØ¬_Ø§Ù„Ù…ÙƒÙ…Ù„} â€” Ø®ØµÙ… 10% Ù„Ùˆ Ø­Ø¨ÙŠØª ØªØ¶ÙŠÙÙ‡\n{Ø±Ø§Ø¨Ø·_Ø§Ù„Ù…Ù†ØªØ¬}', msgLabel:'ğŸ’¬ Ø¯Ø§Ø®Ù„ Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ©:'},
    {id:'vip', icon:'â­', iconBg:'var(--warning-dim)', name:'Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ù…ÙŠØ²ÙŠÙ†', desc:'45 Ø¹Ù…ÙŠÙ„ VIP â€” ÙˆØµÙˆÙ„ Ø­ØµØ±ÙŠ + Ø´Ø­Ù† Ù…Ø¬Ø§Ù†ÙŠ', badge:'ÙˆÙ„Ø§Ø¡', badgeCls:'badge-warning',
     stats:{customers:45, channel:'ÙˆØ§ØªØ³Ø§Ø¨ (Ø´Ø®ØµÙŠ)', discount:'Ø´Ø­Ù† Ù…Ø¬Ø§Ù†ÙŠ + Ø­ØµØ±ÙŠ', revenue:'1,500 Ø±.Ø³'},
     msg:'Ù‡Ù„Ø§ {Ø§Ù„Ø§Ø³Ù…}! Ø£Ù†Øª Ù…Ù† Ø£Ù‡Ù… Ø¹Ù…Ù„Ø§Ø¦Ù†Ø§ ğŸ‘‘\nØ¹Ù†Ø¯Ùƒ ÙˆØµÙˆÙ„ Ø­ØµØ±ÙŠ Ù„Ù…Ù†ØªØ¬Ø§ØªÙ†Ø§ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù‚Ø¨Ù„ Ø§Ù„ÙƒÙ„ + Ø´Ø­Ù† Ù…Ø¬Ø§Ù†ÙŠ\nØ´ÙˆÙ Ø§Ù„Ø¬Ø¯ÙŠØ¯ ğŸ‘‡\n{Ø±Ø§Ø¨Ø·_Ø­ØµØ±ÙŠ}', msgLabel:'ğŸ’¬ Ø±Ø³Ø§Ù„Ø© VIP:'},
    {id:'browse', icon:'ğŸ‘€', iconBg:'var(--info-dim)', name:'ØªØ°ÙƒÙŠØ± Ø§Ù„Ù…ØªØµÙØ­ÙŠÙ†', desc:'534 Ø²Ø§Ø¦Ø± Ø´Ø§ÙÙˆØ§ Ù…Ù†ØªØ¬Ø§Øª Ø¨Ø¯ÙˆÙ† Ø´Ø±Ø§Ø¡', badge:'ØªØ­ÙˆÙŠÙ„', badgeCls:'badge-info',
     stats:{customers:534, channel:'Ø¥ÙŠÙ…ÙŠÙ„ â† SMS', discount:'5%', revenue:'800 Ø±.Ø³'},
     msg:'Ù…Ø±Ø­Ø¨Ø§ {Ø§Ù„Ø§Ø³Ù…}\nÙ„Ø§Ø­Ø¸Ù†Ø§ Ø¥Ù†Ùƒ Ø´ÙØª {Ø§Ù„Ù…Ù†ØªØ¬} â€” Ù„Ø³Ø§ Ù…ØªÙˆÙØ±!\nØ®ØµÙ… 5% Ø®Ø§Øµ Ù„Ùƒ Ù„Ù…Ø¯Ø© 48 Ø³Ø§Ø¹Ø©\nØ´ÙˆÙ Ø§Ù„Ù…Ù†ØªØ¬ ğŸ‘‡\n{Ø±Ø§Ø¨Ø·_Ø§Ù„Ù…Ù†ØªØ¬}', msgLabel:'ğŸ“§ Ø¥ÙŠÙ…ÙŠÙ„ Ø§Ù„ØªØ°ÙƒÙŠØ±:'},
    {id:'review', icon:'â­', iconBg:'var(--whatsapp-dim)', name:'ØªÙ‚ÙŠÙŠÙ…Ø§Øª + Ø¹Ø±ÙˆØ¶ Ù…Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ¹', desc:'Ø¹Ø¨Ø± "ØªØ§Ø¨Ø¹ Ø·Ù„Ø¨Ùƒ Ø¹Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨" â€” Ù…Ø¬Ø§Ù†ÙŠØ© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„', badge:'Ù…Ø¬Ø§Ù†ÙŠ 100%', badgeCls:'badge-whatsapp',
     stats:{customers:'ÙƒÙ„ Ù…Ø´ØªØ±ÙŠ', channel:'SMS â†’ ÙˆØ§ØªØ³Ø§Ø¨ (Ù†Ø§ÙØ°Ø© Ù…Ø¬Ø§Ù†ÙŠØ©)', discount:'10% Ø¨Ø¹Ø¯ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…', revenue:'Ù…Ø³ØªÙ…Ø±'},
     msg:'ØªØ§Ø¨Ø¹ Ø·Ù„Ø¨Ùƒ Ø¹Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨ ğŸ‘‡\nwa.me/966XXXXXXXXX?text=Ù…ØªØ§Ø¨Ø¹Ø©_Ø·Ù„Ø¨_{Ø±Ù‚Ù…_Ø§Ù„Ø·Ù„Ø¨}\n\nâ€” Ø¨Ø¹Ø¯ Ù…Ø§ ÙŠØ±Ø§Ø³Ù„Ùƒ (Ù…Ø¬Ø§Ù†ÙŠ):\nÙ¡. ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ âœ…\nÙ¢. Ø¨Ø¹Ø¯ 3 Ø£ÙŠØ§Ù…: ÙƒÙŠÙ Ø§Ù„Ù…Ù†ØªØ¬ØŸ Ù‚ÙŠÙ‘Ù…Ù†Ø§ Ù…Ù† 5 â­\nÙ£. Ø¨Ø¹Ø¯ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…: Ø´ÙƒØ±Ø§Ù‹! Ø®ØµÙ… 10% Ø¹Ù„Ù‰ Ø·Ù„Ø¨Ùƒ Ø§Ù„Ø¬Ø§ÙŠ ğŸ', msgLabel:'ğŸ“² Ø§Ù„ØªØ³Ù„Ø³Ù„ Ø§Ù„ÙƒØ§Ù…Ù„:'}
];

// â•â•â• PHASE NAVIGATION â•â•â•
function show(id){document.querySelectorAll('.phase').forEach(p=>p.classList.remove('active'));document.getElementById(id).classList.add('active')}

// â•â•â• PHASE 0: DATA SOURCE â•â•â•
function selectSource(src){
    selectedSource=src;
    document.querySelectorAll('.ds-card').forEach(c=>c.classList.remove('selected'));
    document.getElementById('sallaSection').style.display='none';
    document.getElementById('excelSection').style.display='none';
    if(src==='salla'){document.getElementById('dsSalla').classList.add('selected');document.getElementById('sallaSection').style.display='block';}
    if(src==='excel'){document.getElementById('dsExcel').classList.add('selected');document.getElementById('excelSection').style.display='block';}
}
function connectSalla(){
    // In production: redirect to Salla OAuth
    simulateSallaConnected();
}
function simulateSallaConnected(){
    document.getElementById('sallaConnected').style.display='block';
    document.getElementById('sallaSection').innerHTML='<div style="padding:20px;text-align:center;"><span style="font-size:40px">âœ…</span><div style="font-size:16px;font-weight:700;margin-top:12px;">Ù…ØªØ¬Ø± Ø³Ù„Ø© Ù…ØªØµÙ„</div><div style="font-size:12px;color:var(--text-muted);margin-top:4px;">847 Ø¹Ù…ÙŠÙ„ â€” 1,240 Ø·Ù„Ø¨ â€” 23 Ø³Ù„Ø© Ù…ØªØ±ÙˆÙƒØ©</div></div>';
    document.getElementById('proceedBtn').disabled=false;
}
function handleFileUpload(input){
    if(!input.files.length)return;
    const name=input.files[0].name;
    document.getElementById('uploadZone').style.display='none';
    document.getElementById('uploadResult').classList.add('show');
    document.getElementById('uploadCount').textContent='ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ 847 Ø¹Ù…ÙŠÙ„ Ù…Ù† '+name;
    document.getElementById('proceedBtn').disabled=false;
}
// Drag and drop
const uz=document.getElementById('uploadZone');
if(uz){uz.addEventListener('dragover',e=>{e.preventDefault();uz.classList.add('dragover')});uz.addEventListener('dragleave',()=>uz.classList.remove('dragover'));uz.addEventListener('drop',e=>{e.preventDefault();uz.classList.remove('dragover');document.getElementById('uploadZone').style.display='none';document.getElementById('uploadResult').classList.add('show');document.getElementById('proceedBtn').disabled=false;});}

function goToAnalyze(){
    show('phase1');
    const labels={salla:'Ù…ØµØ¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: Ø³Ù„Ø© (847 Ø¹Ù…ÙŠÙ„)',excel:'Ù…ØµØ¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: Ù…Ù„Ù Ø¥ÙƒØ³Ù„ (847 Ø¹Ù…ÙŠÙ„)'};
    document.getElementById('sourceLabel').textContent=labels[selectedSource]||'';
}

// â•â•â• PHASE 2: SCAN â•â•â•
function startScan(){
    show('phase2');
    const steps=document.querySelectorAll('.scan-step');
    let i=0;
    function next(){
        if(i>0){steps[i-1].classList.remove('active');steps[i-1].classList.add('done');steps[i-1].querySelector('.step-dot').textContent='âœ“';}
        if(i<steps.length){steps[i].classList.add('active');i++;setTimeout(next,700+Math.random()*500);}
        else setTimeout(()=>{renderCampaigns();show('phase3');},400);
    }
    next();
}

// â•â•â• PHASE 3: CAMPAIGNS â•â•â•
function renderCampaigns(){
    const el=document.getElementById('campaignsList');
    el.innerHTML=campaigns.map((c,i)=>`
        <div class="camp" id="camp${i}">
            <div class="camp-top">
                <div class="camp-title-row">
                    <div class="camp-ico" style="background:${c.iconBg}">${c.icon}</div>
                    <div><div class="camp-name">${c.name}</div><div class="camp-desc">${c.desc}</div></div>
                </div>
                <span class="badge ${c.badgeCls}">${c.badge}</span>
            </div>
            <div class="camp-stats">
                <div>Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡: <strong>${c.stats.customers}</strong></div>
                <div>Ø§Ù„Ù‚Ù†Ø§Ø©: <strong>${c.stats.channel}</strong></div>
                <div>Ø§Ù„Ø®ØµÙ…: <strong>${c.stats.discount}</strong></div>
                <div>Ø§Ù„Ù…ØªÙˆÙ‚Ø¹: <strong style="color:var(--primary)">${c.stats.revenue}</strong></div>
            </div>
            <div class="msg-prev" id="msg${i}">
                <div class="msg-prev-lbl">${c.msgLabel}</div>
                <div id="msgBody${i}">${c.msg.replace(/\n/g,'<br>')}</div>
            </div>
            <div class="camp-actions">
                <button class="btn btn-secondary" onclick="toggleMsg(${i})">ğŸ‘ï¸ Ù…Ø¹Ø§ÙŠÙ†Ø©</button>
                <button class="btn btn-ghost" onclick="openEdit(${i})">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
            </div>
        </div>`).join('');
}
function toggleMsg(i){document.getElementById('msg'+i).classList.toggle('show')}

// â•â•â• EDIT MODAL â•â•â•
function openEdit(i){editingCampIdx=i;document.getElementById('editTA').value=campaigns[i].msg;document.getElementById('editModal').classList.add('open')}
function closeEdit(){document.getElementById('editModal').classList.remove('open');editingCampIdx=null}
function saveEdit(){
    if(editingCampIdx!==null){
        campaigns[editingCampIdx].msg=document.getElementById('editTA').value;
        const body=document.getElementById('msgBody'+editingCampIdx);
        if(body)body.innerHTML=campaigns[editingCampIdx].msg.replace(/\n/g,'<br>');
    }
    closeEdit();toast('ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ âœ…');
}
function aiRegenerate(){
    const ta=document.getElementById('editTA');
    ta.style.opacity='.5';
    const alts=[
        'Ù…Ø±Ø­Ø¨Ø§ {Ø§Ù„Ø§Ø³Ù…} ğŸ‘‹\nØ´ÙÙ†Ø§ Ø¥Ù†Ùƒ Ù†Ø§Ø³ÙŠ Ø´ÙŠ Ø¨Ø§Ù„Ø³Ù„Ø©!\n{Ø§Ù„Ù…Ù†ØªØ¬} ÙŠÙ†ØªØ¸Ø±Ùƒ â€” Ø§Ù„ÙƒÙ…ÙŠØ© Ù…Ø­Ø¯ÙˆØ¯Ø©\nÙŠÙ„Ø§ Ø®Ù„Ù‘ØµÙ‡Ø§ ğŸ”¥\n{Ø±Ø§Ø¨Ø·_Ø§Ù„Ø³Ù„Ø©}',
        'Ù‡Ù„Ø§ {Ø§Ù„Ø§Ø³Ù…}!\nÙ…Ù†ØªØ¬Ùƒ Ø§Ù„Ù…ÙØ¶Ù„ Ù„Ø³Ø§ Ù…Ø­Ø¬ÙˆØ² Ù„Ùƒ â°\nØ£ÙƒÙ…Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø­ÙŠÙ† ÙˆØ§Ø³ØªÙ…ØªØ¹ Ø¨ØªÙˆØµÙŠÙ„ Ø³Ø±ÙŠØ¹\n{Ø±Ø§Ø¨Ø·_Ø§Ù„Ø³Ù„Ø©}',
        '{Ø§Ù„Ø§Ø³Ù…}ØŒ Ø³Ù„ØªÙƒ ØªÙ†ØªØ¸Ø±Ùƒ! ğŸ›’\n{Ø§Ù„Ù…Ù†ØªØ¬} â€” Ø¨Ø§Ù‚ÙŠ ÙƒÙ…ÙŠØ© Ù‚Ù„ÙŠÙ„Ø©\nÙ„Ø§ ØªÙÙˆÙ‘Øª Ø§Ù„ÙØ±ØµØ© ğŸ‘‡\n{Ø±Ø§Ø¨Ø·_Ø§Ù„Ø³Ù„Ø©}',
        'Ù‡Ù„Ø§ ÙˆØ§Ù„Ù„Ù‡ {Ø§Ù„Ø§Ø³Ù…}\nÙ…Ù†ØªØ¬Ø§ØªÙƒ Ù„Ø³Ø§ Ø¨Ø§Ù„Ø³Ù„Ø©\nØ®Ù„Ù‘Øµ Ø·Ù„Ø¨Ùƒ Ø¨Ø¶ØºØ·Ø© â€” Ø§Ù„ØªÙˆØµÙŠÙ„ Ø¹Ù„ÙŠÙ†Ø§ ğŸšš\n{Ø±Ø§Ø¨Ø·_Ø§Ù„Ø³Ù„Ø©}'
    ];
    setTimeout(()=>{ta.value=alts[Math.floor(Math.random()*alts.length)];ta.style.opacity='1';},600);
}

// â•â•â• CUSTOM CAMPAIGN MODAL â•â•â•
function openCustom(){document.getElementById('customModal').classList.add('open')}
function closeCustom(){document.getElementById('customModal').classList.remove('open')}
document.querySelectorAll('.type-btn').forEach(b=>b.addEventListener('click',()=>{document.querySelectorAll('.type-btn').forEach(x=>x.classList.remove('active'));b.classList.add('active')}));
document.querySelectorAll('.seg-btn').forEach(b=>b.addEventListener('click',()=>{document.querySelectorAll('.seg-btn').forEach(x=>x.classList.remove('active'));b.classList.add('active')}));
function aiCustom(){
    const ta=document.getElementById('customTA');
    ta.style.opacity='.5';
    const t=document.querySelector('.type-btn.active')?.dataset.t;
    const msgs={
        promo:'Ù‡Ù„Ø§ {Ø§Ù„Ø§Ø³Ù…} ğŸ‘‹\nØ¹Ù†Ø¯Ù†Ø§ Ø¹Ø±Ø¶ Ø®Ø§Øµ Ø§Ù„ÙŠÙˆÙ… Ø¨Ø³!\nØ®ØµÙ… 20% Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª\nÙŠÙ„Ø§ Ù„Ø§ ÙŠÙÙˆØªÙƒ ğŸ”¥\n{Ø±Ø§Ø¨Ø·_Ø§Ù„Ù…ØªØ¬Ø±}',
        new_product:'Ù…Ø±Ø­Ø¨Ø§ {Ø§Ù„Ø§Ø³Ù…}!\nÙˆØµÙ„ Ø¹Ù†Ø¯Ù†Ø§ Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯ ÙŠÙ†Ø§Ø³Ø¨Ùƒ\nÙƒÙ† Ø£ÙˆÙ„ Ù…Ù† ÙŠØ¬Ø±Ø¨Ù‡ ğŸ†•\n{Ø±Ø§Ø¨Ø·_Ø§Ù„Ù…Ù†ØªØ¬}',
        flash:'âš¡ ÙÙ„Ø§Ø´ Ø³ÙŠÙ„ â€” 3 Ø³Ø§Ø¹Ø§Øª Ø¨Ø³!\n{Ø§Ù„Ø§Ø³Ù…}ØŒ Ø®ØµÙ… 30% Ø¹Ù„Ù‰ Ø£ÙƒØ«Ø± Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ø¨ÙŠØ¹Ø§Ù‹\nÙŠÙ„Ø§ Ù‚Ø¨Ù„ Ù„Ø§ ÙŠØ®Ù„Øµ Ø§Ù„ÙˆÙ‚Øª â°\n{Ø±Ø§Ø¨Ø·_Ø§Ù„Ù…ØªØ¬Ø±}',
        seasonal:'ğŸŒ™ Ø¹Ø±ÙˆØ¶ Ø±Ù…Ø¶Ø§Ù† ÙˆØµÙ„Øª!\nÙ…Ø±Ø­Ø¨Ø§ {Ø§Ù„Ø§Ø³Ù…}\nØ®ØµÙˆÙ…Ø§Øª ØªØµÙ„ Ø¥Ù„Ù‰ 40% + Ø´Ø­Ù† Ù…Ø¬Ø§Ù†ÙŠ\nØ¬Ù‡Ù‘Ø² Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÙƒ ğŸ‘‡\n{Ø±Ø§Ø¨Ø·_Ø§Ù„Ù…ØªØ¬Ø±}',
        restock:'ğŸ“¦ Ø±Ø¬Ø¹ Ù„Ù„Ù…Ø®Ø²ÙˆÙ†!\n{Ø§Ù„Ø§Ø³Ù…}ØŒ {Ø§Ù„Ù…Ù†ØªØ¬} Ø§Ù„Ù„ÙŠ ÙƒÙ†Øª ØªØ¨ÙŠÙ‡ Ù…ØªÙˆÙØ± Ø§Ù„Ø­ÙŠÙ†\nØ§Ù„ÙƒÙ…ÙŠØ© Ù…Ø­Ø¯ÙˆØ¯Ø© â€” Ù„Ø§ ØªØªØ£Ø®Ø±\n{Ø±Ø§Ø¨Ø·_Ø§Ù„Ù…Ù†ØªØ¬}',
        loyalty:'ğŸ‘‘ Ø£Ù†Øª Ø¹Ù…ÙŠÙ„ Ù…Ù…ÙŠØ² {Ø§Ù„Ø§Ø³Ù…}!\nØ¹Ù†Ø¯Ùƒ Ù†Ù‚Ø§Ø· ÙˆÙ„Ø§Ø¡ Ø¬Ø§Ù‡Ø²Ø©\nØ§Ø³ØªØ¨Ø¯Ù„Ù‡Ø§ Ø¨Ø®ØµÙ… Ø£Ùˆ Ù‡Ø¯ÙŠØ© Ù…Ø¬Ø§Ù†ÙŠØ© ğŸ\n{Ø±Ø§Ø¨Ø·_Ø§Ù„ÙˆÙ„Ø§Ø¡}'
    };
    setTimeout(()=>{ta.value=msgs[t]||msgs.promo;ta.style.opacity='1';},500);
}
function launchCustom(){closeCustom();toast('ØªÙ… Ø¥Ø·Ù„Ø§Ù‚ Ø§Ù„Ø­Ù…Ù„Ø© Ø§Ù„Ù…Ø®ØµØµØ©! ğŸš€');}

// â•â•â• PHASE 4: LIVE â•â•â•
const feedEvents=[
    {ico:'ğŸ“¨',bg:'var(--whatsapp-dim)',name:'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯',txt:'ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø§Ø³ØªØ±Ø¯Ø§Ø¯ Ø³Ù„Ø©'},
    {ico:'ğŸ“¨',bg:'var(--whatsapp-dim)',name:'Ø³Ø§Ø±Ø© Ø§Ù„Ø¹Ù„ÙŠ',txt:'ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø§Ø³ØªØ±Ø¯Ø§Ø¯ Ø³Ù„Ø©'},
    {ico:'ğŸ‘ï¸',bg:'var(--info-dim)',name:'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯',txt:'Ù‚Ø±Ø£ Ø§Ù„Ø±Ø³Ø§Ù„Ø©'},
    {ico:'ğŸ”—',bg:'var(--secondary-dim)',name:'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯',txt:'Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø±Ø§Ø¨Ø·'},
    {ico:'ğŸ’³',bg:'var(--primary-dim)',name:'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯',txt:'Ø£ÙƒÙ…Ù„ Ø§Ù„Ø´Ø±Ø§Ø¡!',amt:385},
    {ico:'ğŸ“¨',bg:'var(--info-dim)',name:'Ù†ÙˆØ±Ø© Ø§Ù„Ø³Ø¹ÙŠØ¯',txt:'ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¥ÙŠÙ…ÙŠÙ„ ØªÙ†Ø´ÙŠØ·'},
    {ico:'ğŸ“¨',bg:'var(--whatsapp-dim)',name:'Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹ØªÙŠØ¨ÙŠ',txt:'ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ù…ÙƒØ§ÙØ£Ø© VIP'},
    {ico:'ğŸ‘ï¸',bg:'var(--info-dim)',name:'Ø³Ø§Ø±Ø© Ø§Ù„Ø¹Ù„ÙŠ',txt:'Ù‚Ø±Ø£Øª Ø§Ù„Ø±Ø³Ø§Ù„Ø©'},
    {ico:'ğŸ’³',bg:'var(--primary-dim)',name:'Ø³Ø§Ø±Ø© Ø§Ù„Ø¹Ù„ÙŠ',txt:'Ø£ÙƒÙ…Ù„Øª Ø§Ù„Ø´Ø±Ø§Ø¡!',amt:210},
    {ico:'ğŸ“¨',bg:'var(--whatsapp-dim)',name:'ÙØ§Ø·Ù…Ø© Ø§Ù„Ø²Ù‡Ø±Ø§Ù†ÙŠ',txt:'ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© ØªÙ†Ø´ÙŠØ·'},
    {ico:'â­',bg:'var(--warning-dim)',name:'ÙŠØ§Ø³Ø± Ø§Ù„Ø¯ÙˆØ³Ø±ÙŠ',txt:'Ø£Ø¹Ø·Ù‰ ØªÙ‚ÙŠÙŠÙ… 5 Ù†Ø¬ÙˆÙ…!'},
    {ico:'ğŸ’³',bg:'var(--primary-dim)',name:'Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹ØªÙŠØ¨ÙŠ',txt:'Ø§Ø´ØªØ±Ù‰ Ù…Ù†ØªØ¬ Ø¥Ø¶Ø§ÙÙŠ!',amt:540},
    {ico:'ğŸ‘ï¸',bg:'var(--info-dim)',name:'Ù†ÙˆØ±Ø© Ø§Ù„Ø³Ø¹ÙŠØ¯',txt:'ÙØªØ­Øª Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„'},
    {ico:'ğŸ’¬',bg:'var(--whatsapp-dim)',name:'ÙØ§Ø·Ù…Ø© Ø§Ù„Ø²Ù‡Ø±Ø§Ù†ÙŠ',txt:'Ø±Ø¯Øª: "ÙˆØ´ Ø§Ù„Ø¹Ø±Ø¶ØŸ"'},
    {ico:'ğŸ’³',bg:'var(--primary-dim)',name:'Ù‡Ù†Ø¯ Ø§Ù„Ù…Ø§Ù„ÙƒÙŠ',txt:'Ø£ÙƒÙ…Ù„Øª Ø§Ù„Ø´Ø±Ø§Ø¡ Ù…Ù† Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„!',amt:290},
    {ico:'ğŸ“¨',bg:'var(--whatsapp-dim)',name:'Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ',txt:'ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¨ÙŠØ¹ Ø¥Ø¶Ø§ÙÙŠ'},
    {ico:'ğŸ’³',bg:'var(--primary-dim)',name:'ÙØ§Ø·Ù…Ø© Ø§Ù„Ø²Ù‡Ø±Ø§Ù†ÙŠ',txt:'Ø±Ø¬Ø¹Øª ÙˆØ§Ø´ØªØ±Øª!',amt:175},
    {ico:'ğŸ’³',bg:'var(--primary-dim)',name:'Ø±ÙŠÙ… Ø§Ù„Ø´Ù…Ø±ÙŠ',txt:'Ø³Ù„Ø© Ù…Ø³ØªØ±Ø¯Ø©!',amt:420},
    {ico:'â­',bg:'var(--warning-dim)',name:'Ù…Ø­Ù…Ø¯ Ø§Ù„Ø£Ø­Ù…Ø¯',txt:'Ø£Ø¹Ø·Ù‰ ØªÙ‚ÙŠÙŠÙ… 4 Ù†Ø¬ÙˆÙ…'},
    {ico:'ğŸ’³',bg:'var(--primary-dim)',name:'Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ',txt:'Ø§Ø´ØªØ±Ù‰ Ù…Ù† Ø§Ù„Ø¨ÙŠØ¹ Ø§Ù„Ø¥Ø¶Ø§ÙÙŠ!',amt:310},
];

const insights=[
    'Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„ØµØ¨Ø§Ø­ÙŠØ© ØªØ­Ù‚Ù‚ Ø¶Ø¹Ù Ø§Ù„ØªØ­ÙˆÙŠÙ„ â€” ØªÙ… ØªØ­ÙˆÙŠÙ„ 60% Ù…Ù† Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„ÙØªØ±Ø© Ø§Ù„ØµØ¨Ø§Ø­ÙŠØ©',
    'Ø¹Ù…Ù„Ø§Ø¡ Ø´Ø±ÙŠØ­Ø© "Ø§Ù„Ù…Ù…ÙŠØ²ÙŠÙ†" ØªÙØ§Ø¹Ù„ÙˆØ§ Ø¨Ù†Ø³Ø¨Ø© 78% â€” Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø´Ø®ØµÙŠØ© ØªØ¹Ù…Ù„ Ù…Ù…ØªØ§Ø²',
    'Ø±Ø³Ø§Ø¦Ù„ Ø¨Ø¯ÙˆÙ† Ø®ØµÙ… Ø­Ù‚Ù‚Øª 40% ØªØ­ÙˆÙŠÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø³Ù„Ø§Øª â€” Ø£ØºÙ„Ø¨ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙŠØ­ØªØ§Ø¬ÙˆÙ† ØªØ°ÙƒÙŠØ± ÙÙ‚Ø·',
    'Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ ÙŠØ¹Ù…Ù„ Ø£ÙØ¶Ù„ Ù„Ø´Ø±ÙŠØ­Ø© Ø§Ù„Ù…ØªØµÙØ­ÙŠÙ† â€” ØªÙ… ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù‚Ù†Ø§Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹',
    'Ø±Ø¯ÙˆØ¯ Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø© ØªØ¶Ø§Ø¹Ù Ù†Ø³Ø¨Ø© Ø§Ù„Ø´Ø±Ø§Ø¡ â€” Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ±Ø¯ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª'
];

function goLive(){
    show('phase4');
    liveRevenue=0;feedIdx=0;
    counters={carts:0,winback:0,upsell:0,vip:0,browse:0,reviews:0};
    renderLiveCamps();
    document.getElementById('feedItems').innerHTML='<div class="fi" style="justify-content:center;color:var(--text-dim);padding:32px;">Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø£ÙˆÙ„ Ø±Ø³Ø§Ù„Ø©...</div>';
    if(liveTimer)clearTimeout(liveTimer);
    runFeed();
}

function renderLiveCamps(){
    const d=[
        {ico:'ğŸ›’',bg:'var(--primary-dim)',name:'Ø§Ù„Ø³Ù„Ø§Øª',id:'lc0',max:23,sub:'Ù…Ø³ØªØ±Ø¯Ø©'},
        {ico:'ğŸ’¤',bg:'var(--danger-dim)',name:'ØªÙ†Ø´ÙŠØ·',id:'lc1',max:156,sub:'Ø±Ø¬Ø¹ÙˆØ§'},
        {ico:'ğŸ',bg:'var(--secondary-dim)',name:'Ø¨ÙŠØ¹ Ø¥Ø¶Ø§ÙÙŠ',id:'lc2',max:89,sub:'Ø§Ø´ØªØ±ÙˆØ§'},
        {ico:'â­',bg:'var(--warning-dim)',name:'VIP',id:'lc3',max:45,sub:'ØªÙØ§Ø¹Ù„ÙˆØ§'},
        {ico:'ğŸ‘€',bg:'var(--info-dim)',name:'Ù…ØªØµÙØ­ÙŠÙ†',id:'lc4',max:534,sub:'Ù†Ù‚Ø±ÙˆØ§'},
        {ico:'â­',bg:'var(--whatsapp-dim)',name:'ØªÙ‚ÙŠÙŠÙ…Ø§Øª',id:'lc5',max:'',sub:'ØªÙ‚ÙŠÙŠÙ…'}
    ];
    document.getElementById('liveCamps').innerHTML=d.map(c=>`
        <div class="lc"><div class="lc-top"><div class="lc-ico" style="background:${c.bg}">${c.ico}</div><div class="lc-name">${c.name}</div></div>
        <div class="lc-val" id="${c.id}">0${c.max?'/'+c.max:''}</div><div class="lc-sub">${c.sub}</div></div>`).join('');
}

function runFeed(){
    if(feedIdx>=feedEvents.length)return;
    const e=feedEvents[feedIdx];feedIdx++;
    if(feedIdx===1)document.getElementById('feedItems').innerHTML='';

    if(e.amt){
        liveRevenue+=e.amt;
        document.getElementById('liveRev').textContent=liveRevenue.toLocaleString('ar-SA');
        const pct=Math.min(100,(liveRevenue/12400)*100);
        document.getElementById('liveBar').style.width=pct+'%';
        document.getElementById('liveBarTxt').textContent=Math.round(pct)+'% Ù…Ù† Ø§Ù„Ù‡Ø¯Ù (12,400 Ø±.Ø³)';
        counters.carts=Math.min(counters.carts+1,8);
        document.getElementById('lc0').textContent=counters.carts+'/23';
    }
    if(e.ico==='â­'){counters.reviews++;document.getElementById('lc5').textContent=counters.reviews;}
    if(feedIdx%3===0){counters.winback=Math.min(counters.winback+1,12);document.getElementById('lc1').textContent=counters.winback+'/156';}
    if(feedIdx%5===0){counters.upsell=Math.min(counters.upsell+1,5);document.getElementById('lc2').textContent=counters.upsell+'/89';}
    if(feedIdx%4===0){counters.vip=Math.min(counters.vip+1,8);document.getElementById('lc3').textContent=counters.vip+'/45';}
    if(feedIdx%6===0){counters.browse=Math.min(counters.browse+1,15);document.getElementById('lc4').textContent=counters.browse+'/534';}

    const min=feedIdx*2+Math.floor(Math.random()*3);
    const fi=document.createElement('div');fi.className='fi';
    fi.innerHTML=`<div class="fi-ico" style="background:${e.bg}">${e.ico}</div><div class="fi-txt"><strong>${e.name}</strong> â€” ${e.txt}</div>${e.amt?`<div class="fi-amt">${e.amt} Ø±.Ø³</div>`:''}<div class="fi-time">Ù…Ù†Ø° ${min} Ø¯</div>`;
    const feed=document.getElementById('feedItems');
    feed.insertBefore(fi,feed.firstChild);

    if(feedIdx%4===0){
        const ins=insights[Math.floor((feedIdx/4)-1)];
        if(ins)document.getElementById('aiBox').innerHTML=`<div class="ai-box-lbl">ğŸ’¡ Ø°ÙƒØ§Ø¡ Ø§Ù„Ø±Ø¨Ø­</div>${ins}`;
    }

    liveTimer=setTimeout(runFeed,1500+Math.random()*2000);
}

function pauseAll(){
    if(liveTimer)clearTimeout(liveTimer);
    toast('ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø­Ù…Ù„Ø§Øª Ù…Ø¤Ù‚ØªØ§Ù‹');
    liveRevenue=0;feedIdx=0;counters={carts:0,winback:0,upsell:0,vip:0,browse:0,reviews:0};
    show('phase1');
}

// â•â•â• TOAST â•â•â•
function toast(msg){const el=document.createElement('div');el.className='toast';el.textContent=msg;document.body.appendChild(el);setTimeout(()=>el.remove(),3000);}
</script>
</body>
</html>

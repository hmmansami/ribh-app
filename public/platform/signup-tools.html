<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ | Ø±ÙØ¨Ø­</title>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/platform/shared/shell.css">
</head>
<body>

<div id="page-content">

    <!-- Page Header -->
    <div class="page-header">
        <h1 class="page-title">Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</h1>
        <p class="page-subtitle">Ø§Ø¬Ù…Ø¹ Ù…Ø´ØªØ±ÙƒÙŠÙ† Ù…Ù† ÙƒÙ„ Ù…ÙƒØ§Ù† â€” Ø§Ù„Ù…ØªØ¬Ø±ØŒ Ø§Ù„Ù…Ø­Ù„ØŒ Ø§Ù„Ø³ÙˆØ´Ø§Ù„ Ù…ÙŠØ¯ÙŠØ§</p>
        <div class="header-kpis">
            <div class="header-kpi">
                <span class="header-kpi-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ†</span>
                <span class="header-kpi-value" data-count="1247">0</span>
            </div>
            <div class="header-kpi-sep"></div>
            <div class="header-kpi">
                <span class="header-kpi-label">Ø¬Ø¯Ø¯ Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</span>
                <span class="header-kpi-value accent" data-count="42">+0</span>
            </div>
            <div class="header-kpi-sep"></div>
            <div class="header-kpi">
                <span class="header-kpi-label">Ø£ÙØ¶Ù„ Ø£Ø¯Ø§Ø©</span>
                <span class="header-kpi-value best-tool">Ø¨ÙˆØ¨ Ø§Ø¨ Ø§Ù„Ù…ØªØ¬Ø±</span>
            </div>
        </div>
    </div>

    <!-- Tools Grid -->
    <div class="tools-grid" id="toolsGrid">
        <!-- Tool cards rendered by JS -->
    </div>

    <!-- Tool Config Panels (hidden by default) -->
    <div id="configPanels">

        <!-- Popup Builder Panel -->
        <div class="config-panel" id="panel-popup" style="display:none;">
            <div class="config-panel-header">
                <div>
                    <h2 class="card-title">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨ÙˆØ¨ Ø§Ø¨ Ø§Ù„Ù…ØªØ¬Ø±</h2>
                    <p class="card-subtitle">Ø£Ù†Ø´Ø¦ Ø¨ÙˆØ¨ Ø§Ø¨ Ø¬Ø°Ø§Ø¨ ÙŠØ­ÙˆÙ„ Ø§Ù„Ø²ÙˆØ§Ø± Ø¥Ù„Ù‰ Ù…Ø´ØªØ±ÙƒÙŠÙ† ÙˆØ§ØªØ³Ø§Ø¨</p>
                </div>
                <button class="btn btn-ghost" onclick="closeConfigPanel()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                    Ø¥ØºÙ„Ø§Ù‚
                </button>
            </div>

            <div class="builder-layout">
                <!-- Left: Config Form -->
                <div class="builder-config">
                    <div class="input-group">
                        <label class="input-label">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¨ÙˆØ¨ Ø§Ø¨</label>
                        <input type="text" class="input" id="popupTitle" value="Ø§Ù†ØªØ¸Ø±! Ø¹Ù†Ø¯Ùƒ Ø®ØµÙ… 15%" oninput="updatePopupPreview()">
                    </div>
                    <div class="input-group">
                        <label class="input-label">Ø§Ù„Ù†Øµ</label>
                        <textarea class="input" id="popupBody" rows="2" oninput="updatePopupPreview()">Ø§Ø´ØªØ±Ùƒ ÙÙŠ ÙˆØ§ØªØ³Ø§Ø¨ ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø®ØµÙ… ÙÙˆØ±ÙŠ</textarea>
                    </div>
                    <div class="grid-2">
                        <div class="input-group">
                            <label class="input-label">Ù†Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ… %</label>
                            <div class="range-wrap">
                                <input type="range" class="range-input" id="popupDiscount" min="5" max="50" value="15" oninput="updatePopupPreview()">
                                <span class="range-value" id="discountDisplay">15%</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label class="input-label">Ø§Ù„ØªÙˆÙ‚ÙŠØª</label>
                            <select class="input" id="popupTiming">
                                <option value="exit">Ø¹Ù†Ø¯ Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø®Ø±ÙˆØ¬</option>
                                <option value="30s">Ø¨Ø¹Ø¯ 30 Ø«Ø§Ù†ÙŠØ©</option>
                                <option value="scroll">Ø¨Ø¹Ø¯ Ø§Ù„ØªØµÙØ­ (50%)</option>
                            </select>
                        </div>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Ø§Ù„ØµÙØ­Ø§Øª</label>
                        <select class="input" id="popupPages">
                            <option value="all">ÙƒÙ„ Ø§Ù„ØµÙØ­Ø§Øª</option>
                            <option value="products">ØµÙØ­Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙ‚Ø·</option>
                            <option value="cart">Ø§Ù„Ø³Ù„Ø© ÙÙ‚Ø·</option>
                        </select>
                    </div>
                    <div class="grid-2">
                        <div class="input-group">
                            <label class="input-label">Ù„ÙˆÙ† Ø§Ù„Ø²Ø±</label>
                            <div class="color-input-wrap">
                                <input type="color" class="color-input" id="popupBtnColor" value="#22C55E" oninput="updatePopupPreview()">
                                <span class="color-hex" id="btnColorHex">#22C55E</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label class="input-label">Ù„ÙˆÙ† Ø§Ù„Ø®Ù„ÙÙŠØ©</label>
                            <div class="color-input-wrap">
                                <input type="color" class="color-input" id="popupBgColor" value="#111111" oninput="updatePopupPreview()">
                                <span class="color-hex" id="bgColorHex">#111111</span>
                            </div>
                        </div>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Ù†Øµ Ø§Ù„Ø²Ø±</label>
                        <input type="text" class="input" id="popupCta" value="Ø§Ø´ØªØ±Ùƒ Ø§Ù„Ø­ÙŠÙ†" oninput="updatePopupPreview()">
                    </div>
                    <div class="input-group">
                        <label class="input-label">ÙƒÙˆØ¯ Ø§Ù„ØªØ¶Ù…ÙŠÙ†</label>
                        <div class="embed-code-wrap">
                            <pre class="embed-code" id="popupEmbedCode">&lt;script src="https://ribh-484706.web.app/widget/exit-popup.js" data-store="STORE_ID"&gt;&lt;/script&gt;</pre>
                            <button class="btn btn-sm btn-secondary embed-copy" onclick="copyEmbed('popupEmbedCode')">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                                Ù†Ø³Ø®
                            </button>
                        </div>
                    </div>
                    <button class="btn btn-primary w-full mt-16" onclick="savePopupConfig()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>
                        Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                    </button>
                </div>

                <!-- Right: Live Preview -->
                <div class="builder-preview">
                    <div class="preview-label">Ù…Ø¹Ø§ÙŠÙ†Ø© Ù…Ø¨Ø§Ø´Ø±Ø©</div>
                    <div class="phone-mockup">
                        <div class="phone-notch">
                            <div class="phone-notch-inner"></div>
                        </div>
                        <div class="phone-status-bar">
                            <span>9:41</span>
                            <div class="phone-status-icons">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M1 9l2 2c4.97-4.97 13.03-4.97 18 0l2-2C16.93 2.93 7.08 2.93 1 9zm8 8l3 3 3-3c-1.65-1.66-4.34-1.66-6 0zm-4-4l2 2c2.76-2.76 7.24-2.76 10 0l2-2C15.14 9.14 8.87 9.14 5 13z"/></svg>
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><rect x="17" y="4" width="3" height="16" rx="1"/><rect x="11" y="8" width="3" height="12" rx="1"/><rect x="5" y="12" width="3" height="8" rx="1"/></svg>
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><rect x="2" y="6" width="18" height="12" rx="2" stroke="currentColor" stroke-width="1.5" fill="none"/><rect x="4" y="8" width="10" height="8" rx="1"/><path d="M22 10v4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
                            </div>
                        </div>
                        <div class="phone-content">
                            <div class="phone-store-bg">
                                <div class="phone-store-nav"></div>
                                <div class="phone-store-hero"></div>
                                <div class="phone-store-products">
                                    <div class="phone-product-card"></div>
                                    <div class="phone-product-card"></div>
                                </div>
                            </div>
                            <div class="phone-overlay">
                                <div class="phone-popup" id="phonePopup">
                                    <button class="phone-popup-close">x</button>
                                    <div class="phone-popup-icon">
                                        <svg width="28" height="28" viewBox="0 0 24 24" fill="#22C55E"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347z"/><path d="M12 2C6.477 2 2 6.477 2 12c0 1.89.525 3.66 1.438 5.168L2 22l4.832-1.438A9.955 9.955 0 0 0 12 22c5.523 0 10-4.477 10-10S17.523 2 12 2z"/></svg>
                                    </div>
                                    <div class="phone-popup-title" id="previewTitle">Ø§Ù†ØªØ¸Ø±! Ø¹Ù†Ø¯Ùƒ Ø®ØµÙ… 15%</div>
                                    <div class="phone-popup-body" id="previewBody">Ø§Ø´ØªØ±Ùƒ ÙÙŠ ÙˆØ§ØªØ³Ø§Ø¨ ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø®ØµÙ… ÙÙˆØ±ÙŠ</div>
                                    <div class="phone-popup-discount" id="previewDiscount">15%</div>
                                    <button class="phone-popup-cta" id="previewCta">Ø§Ø´ØªØ±Ùƒ Ø§Ù„Ø­ÙŠÙ†</button>
                                    <div class="phone-popup-footer">Ø¨Ø§Ù„Ø¶ØºØ· ØªÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ø³ØªÙ„Ø§Ù… Ø±Ø³Ø§Ø¦Ù„ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</div>
                                </div>
                            </div>
                        </div>
                        <div class="phone-home-bar"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- WhatsApp Widget Panel -->
        <div class="config-panel" id="panel-widget" style="display:none;">
            <div class="config-panel-header">
                <div>
                    <h2 class="card-title">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆÙŠØ¯Ø¬Øª ÙˆØ§ØªØ³Ø§Ø¨</h2>
                    <p class="card-subtitle">Ø²Ø± ÙˆØ§ØªØ³Ø§Ø¨ Ø¹Ø§Ø¦Ù… ÙŠØ¸Ù‡Ø± Ù„Ø²ÙˆØ§Ø± Ø§Ù„Ù…ØªØ¬Ø±</p>
                </div>
                <button class="btn btn-ghost" onclick="closeConfigPanel()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                    Ø¥ØºÙ„Ø§Ù‚
                </button>
            </div>
            <div class="builder-layout">
                <div class="builder-config">
                    <div class="input-group">
                        <label class="input-label">Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨</label>
                        <input type="text" class="input" id="widgetMessage" value="Ù…Ø±Ø­Ø¨Ø§! ÙƒÙŠÙ Ù†Ù‚Ø¯Ø± Ù†Ø³Ø§Ø¹Ø¯ÙƒØŸ" oninput="updateWidgetPreview()">
                    </div>
                    <div class="input-group">
                        <label class="input-label">Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø²Ø±</label>
                        <div class="position-toggle">
                            <button class="pos-btn active" data-pos="right" onclick="setWidgetPos('right')">ÙŠÙ…ÙŠÙ†</button>
                            <button class="pos-btn" data-pos="left" onclick="setWidgetPos('left')">ÙŠØ³Ø§Ø±</button>
                        </div>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Ù„ÙˆÙ† Ø§Ù„Ø²Ø±</label>
                        <div class="color-input-wrap">
                            <input type="color" class="color-input" id="widgetColor" value="#22C55E" oninput="updateWidgetPreview()">
                            <span class="color-hex" id="widgetColorHex">#22C55E</span>
                        </div>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Ø¥Ø¸Ù‡Ø§Ø± Ø¨Ø¹Ø¯ (Ø«ÙˆØ§Ù†ÙŠ)</label>
                        <input type="number" class="input" id="widgetDelay" value="3" min="0" max="60">
                    </div>
                    <div class="input-group">
                        <label class="input-label">ÙƒÙˆØ¯ Ø§Ù„ØªØ¶Ù…ÙŠÙ†</label>
                        <div class="embed-code-wrap">
                            <pre class="embed-code" id="widgetEmbedCode">&lt;script src="https://ribh-484706.web.app/widget/wa-widget.js" data-store="STORE_ID" data-color="#22C55E" data-position="right"&gt;&lt;/script&gt;</pre>
                            <button class="btn btn-sm btn-secondary embed-copy" onclick="copyEmbed('widgetEmbedCode')">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                                Ù†Ø³Ø®
                            </button>
                        </div>
                    </div>
                    <button class="btn btn-primary w-full mt-16" onclick="saveWidgetConfig()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>
                        Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                    </button>
                </div>
                <div class="builder-preview">
                    <div class="preview-label">Ù…Ø¹Ø§ÙŠÙ†Ø©</div>
                    <div class="widget-preview-area" id="widgetPreviewArea">
                        <div class="widget-preview-bubble" id="widgetBubble">
                            <span id="widgetBubbleText">Ù…Ø±Ø­Ø¨Ø§! ÙƒÙŠÙ Ù†Ù‚Ø¯Ø± Ù†Ø³Ø§Ø¹Ø¯ÙƒØŸ</span>
                        </div>
                        <div class="widget-preview-btn" id="widgetBtn">
                            <svg width="28" height="28" viewBox="0 0 24 24" fill="#fff"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347z"/><path d="M12 2C6.477 2 2 6.477 2 12c0 1.89.525 3.66 1.438 5.168L2 22l4.832-1.438A9.955 9.955 0 0 0 12 22c5.523 0 10-4.477 10-10S17.523 2 12 2z"/></svg>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- QR Code Panel -->
        <div class="config-panel" id="panel-qr" style="display:none;">
            <div class="config-panel-header">
                <div>
                    <h2 class="card-title">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙƒÙˆØ¯ QR</h2>
                    <p class="card-subtitle">ÙƒÙˆØ¯ QR Ù„Ù„Ù…Ø­Ù„ Ø§Ù„ÙØ¹Ù„ÙŠ â€” Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙŠÙ…Ø³Ø­ ÙˆÙŠØ´ØªØ±Ùƒ ÙÙˆØ±Ø§</p>
                </div>
                <button class="btn btn-ghost" onclick="closeConfigPanel()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                    Ø¥ØºÙ„Ø§Ù‚
                </button>
            </div>
            <div class="builder-layout">
                <div class="builder-config">
                    <div class="input-group">
                        <label class="input-label">Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨</label>
                        <input type="text" class="input" id="qrPhone" placeholder="05XXXXXXXX" dir="ltr" style="text-align:left;">
                    </div>
                    <div class="input-group">
                        <label class="input-label">Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©</label>
                        <input type="text" class="input" id="qrMessage" value="Ø£Ø¨ÙŠ Ø£Ø´ØªØ±Ùƒ ÙÙŠ Ø§Ù„Ø¹Ø±ÙˆØ¶">
                    </div>
                    <div class="input-group">
                        <label class="input-label">Ø§Ø³Ù… Ø§Ù„Ø­Ù…Ù„Ø© (Ù„Ù„ØªØªØ¨Ø¹)</label>
                        <input type="text" class="input" id="qrCampaign" value="Ù…Ø­Ù„ Ø§Ù„Ø±ÙŠØ§Ø¶">
                    </div>
                    <button class="btn btn-primary w-full" onclick="generateQR()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="3" height="3"/><path d="M21 14h-3v3"/><path d="M14 21h3v-3"/><path d="M21 21h-3"/></svg>
                        Ø¥Ù†Ø´Ø§Ø¡ ÙƒÙˆØ¯ QR
                    </button>
                    <div class="qr-note mt-16">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--info)" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
                        <span>Ø§Ù„ÙƒÙˆØ¯ Ø¬Ø§Ù‡Ø² Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© Ø¨Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ© (300 DPI) â€” Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„ÙƒØ§ÙˆÙ†ØªØ±ØŒ Ø§Ù„Ø£ÙƒÙŠØ§Ø³ØŒ ÙˆØ§Ù„ÙÙˆØ§ØªÙŠØ±</span>
                    </div>
                </div>
                <div class="builder-preview">
                    <div class="preview-label">Ø§Ù„ÙƒÙˆØ¯</div>
                    <div class="qr-preview-area">
                        <div class="qr-placeholder" id="qrOutput">
                            <div class="qr-grid">
                                <div class="qr-block b1"></div><div class="qr-block b2"></div><div class="qr-block b3"></div>
                                <div class="qr-block b4"></div><div class="qr-block b5"></div><div class="qr-block b6"></div>
                                <div class="qr-block b7"></div><div class="qr-block b8"></div><div class="qr-block b9"></div>
                            </div>
                            <div class="qr-logo-center">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="#22C55E"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347z"/><path d="M12 2C6.477 2 2 6.477 2 12c0 1.89.525 3.66 1.438 5.168L2 22l4.832-1.438A9.955 9.955 0 0 0 12 22c5.523 0 10-4.477 10-10S17.523 2 12 2z"/></svg>
                            </div>
                        </div>
                        <div class="qr-actions mt-16">
                            <button class="btn btn-secondary btn-sm" onclick="downloadQR()">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                                ØªØ­Ù…ÙŠÙ„ PNG
                            </button>
                            <button class="btn btn-secondary btn-sm" onclick="downloadQR('pdf')">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
                                ØªØ­Ù…ÙŠÙ„ PDF
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Social Link Panel -->
        <div class="config-panel" id="panel-social" style="display:none;">
            <div class="config-panel-header">
                <div>
                    <h2 class="card-title">Ø±Ø§Ø¨Ø· Ø³ÙˆØ´Ø§Ù„ Ù…ÙŠØ¯ÙŠØ§</h2>
                    <p class="card-subtitle">Ø±Ø§Ø¨Ø· Ø§Ø´ØªØ±Ø§Ùƒ Ù…Ø¨Ø§Ø´Ø± Ù„Ù„Ø¨Ø§ÙŠÙˆ ÙˆØ§Ù„Ø³ØªÙˆØ±ÙŠ</p>
                </div>
                <button class="btn btn-ghost" onclick="closeConfigPanel()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                    Ø¥ØºÙ„Ø§Ù‚
                </button>
            </div>
            <div class="card" style="max-width:600px;">
                <div class="input-group">
                    <label class="input-label">Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø®ØµØµ</label>
                    <div class="embed-code-wrap">
                        <pre class="embed-code" id="socialLink">https://wa.me/966XXXXXXXXX?text=Ø£Ø¨ÙŠ%20Ø£Ø´ØªØ±Ùƒ</pre>
                        <button class="btn btn-sm btn-secondary embed-copy" onclick="copyEmbed('socialLink')">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                            Ù†Ø³Ø®
                        </button>
                    </div>
                </div>
                <div class="input-group">
                    <label class="input-label">Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø®ØªØµØ±</label>
                    <div class="embed-code-wrap">
                        <pre class="embed-code" id="socialShortLink">https://ribh.me/s/abc123</pre>
                        <button class="btn btn-sm btn-secondary embed-copy" onclick="copyEmbed('socialShortLink')">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                            Ù†Ø³Ø®
                        </button>
                    </div>
                </div>
                <p class="text-sm text-dim mt-8">Ø§Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· ÙˆØ­Ø·Ù‡ ÙÙŠ Ø§Ù„Ø¨Ø§ÙŠÙˆ Ø£Ùˆ Ø´Ø§Ø±ÙƒÙ‡ ÙÙŠ Ø§Ù„Ø³ØªÙˆØ±ÙŠ</p>
            </div>
        </div>

        <!-- CSV Import Panel -->
        <div class="config-panel" id="panel-csv" style="display:none;">
            <div class="config-panel-header">
                <div>
                    <h2 class="card-title">Ø§Ø³ØªÙŠØ±Ø§Ø¯ CSV</h2>
                    <p class="card-subtitle">Ø§Ø³ØªÙˆØ±Ø¯ Ø¹Ù…Ù„Ø§Ø¦Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠÙŠÙ† Ù…Ù† Ù…Ù„Ù Ø§ÙƒØ³Ù„ Ø£Ùˆ CSV</p>
                </div>
                <button class="btn btn-ghost" onclick="closeConfigPanel()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                    Ø¥ØºÙ„Ø§Ù‚
                </button>
            </div>
            <div class="card" style="max-width:600px;">
                <div class="csv-upload-zone" id="csvZone" ondragover="event.preventDefault();this.classList.add('drag-over')" ondragleave="this.classList.remove('drag-over')" ondrop="handleCSVDrop(event)">
                    <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="var(--text-dim)" stroke-width="1.5"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
                    <p class="mt-8">Ø§Ø³Ø­Ø¨ Ø§Ù„Ù…Ù„Ù Ù‡Ù†Ø§ Ø£Ùˆ</p>
                    <button class="btn btn-secondary btn-sm mt-8" onclick="document.getElementById('csvFile').click()">Ø§Ø®ØªØ± Ù…Ù„Ù</button>
                    <input type="file" id="csvFile" accept=".csv,.xlsx,.xls" style="display:none" onchange="handleCSVFile(this)">
                    <p class="text-sm text-dim mt-8">CSV Ø£Ùˆ Excel â€” ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ø¹Ù…ÙˆØ¯ Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„</p>
                </div>
                <div class="csv-result mt-16" id="csvResult" style="display:none;">
                    <div class="flex items-center justify-between">
                        <span class="text-sm">ØªÙ… Ø±ÙØ¹ <strong id="csvCount">0</strong> Ø¬Ù‡Ø© Ø§ØªØµØ§Ù„</span>
                        <button class="btn btn-primary btn-sm" onclick="importCSV()">Ø§Ø³ØªÙŠØ±Ø§Ø¯</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Custom Landing Panel -->
        <div class="config-panel" id="panel-landing" style="display:none;">
            <div class="config-panel-header">
                <div>
                    <h2 class="card-title">ØµÙØ­Ø© Ù‡Ø¨ÙˆØ· Ù…Ø®ØµØµØ©</h2>
                    <p class="card-subtitle">ØµÙØ­Ø© Ù‡Ø¨ÙˆØ· Ù…Ø®ØµØµØ© Ù„Ø¬Ù…Ø¹ Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ†</p>
                </div>
                <button class="btn btn-ghost" onclick="closeConfigPanel()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                    Ø¥ØºÙ„Ø§Ù‚
                </button>
            </div>
            <div class="card" style="max-width:600px;">
                <div class="empty-state">
                    <div class="empty-state-icon">ğŸš€</div>
                    <div class="empty-state-title">Ù‚Ø±ÙŠØ¨Ø§</div>
                    <div class="empty-state-desc">Ù†Ø´ØªØºÙ„ Ø¹Ù„Ù‰ Ù…Ø­Ø±Ø± ØµÙØ­Ø§Øª Ù‡Ø¨ÙˆØ· â€” Ø±Ø§Ø­ ØªÙ‚Ø¯Ø± ØªÙ†Ø´Ø¦ ØµÙØ­Ø© Ø¨Ø¯ÙˆÙ† Ø£ÙŠ ÙƒÙˆØ¯</div>
                </div>
            </div>
        </div>

    </div>

    <!-- Performance Analytics -->
    <div class="card mt-24" id="analyticsSection">
        <div class="card-header">
            <div>
                <div class="card-title">Ø£Ø¯Ø§Ø¡ Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</div>
                <div class="card-subtitle">Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± 30 ÙŠÙˆÙ…</div>
            </div>
        </div>
        <div class="analytics-grid">
            <div class="analytics-chart">
                <div class="chart-bars" id="chartBars">
                    <!-- Rendered by JS -->
                </div>
            </div>
            <div class="analytics-summary">
                <div class="summary-item">
                    <div class="summary-dot" style="background:var(--success);"></div>
                    <div class="summary-info">
                        <span class="summary-label">Ø¨ÙˆØ¨ Ø§Ø¨ Ø§Ù„Ù…ØªØ¬Ø±</span>
                        <span class="summary-value">523 Ù…Ø´ØªØ±Ùƒ</span>
                    </div>
                    <span class="summary-pct">42%</span>
                </div>
                <div class="summary-item">
                    <div class="summary-dot" style="background:var(--info);"></div>
                    <div class="summary-info">
                        <span class="summary-label">ÙˆÙŠØ¯Ø¬Øª ÙˆØ§ØªØ³Ø§Ø¨</span>
                        <span class="summary-value">312 Ù…Ø´ØªØ±Ùƒ</span>
                    </div>
                    <span class="summary-pct">25%</span>
                </div>
                <div class="summary-item">
                    <div class="summary-dot" style="background:var(--primary);"></div>
                    <div class="summary-info">
                        <span class="summary-label">ÙƒÙˆØ¯ QR</span>
                        <span class="summary-value">189 Ù…Ø´ØªØ±Ùƒ</span>
                    </div>
                    <span class="summary-pct">15%</span>
                </div>
                <div class="summary-item">
                    <div class="summary-dot" style="background:var(--warning);"></div>
                    <div class="summary-info">
                        <span class="summary-label">Ø³ÙˆØ´Ø§Ù„ Ù…ÙŠØ¯ÙŠØ§</span>
                        <span class="summary-value">145 Ù…Ø´ØªØ±Ùƒ</span>
                    </div>
                    <span class="summary-pct">12%</span>
                </div>
                <div class="summary-item">
                    <div class="summary-dot" style="background:var(--text-dim);"></div>
                    <div class="summary-info">
                        <span class="summary-label">CSV + Ø£Ø®Ø±Ù‰</span>
                        <span class="summary-value">78 Ù…Ø´ØªØ±Ùƒ</span>
                    </div>
                    <span class="summary-pct">6%</span>
                </div>
            </div>
        </div>
    </div>

</div>

<style>
/* ============================================
   SIGNUP TOOLS â€” Page Styles
   ============================================ */

/* Header KPIs */
.header-kpis {
    display: flex;
    align-items: center;
    gap: 20px;
    margin-top: 16px;
    padding: 14px 20px;
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
}
.header-kpi { display: flex; align-items: center; gap: 10px; }
.header-kpi-label { font-size: 13px; color: var(--text-dim); }
.header-kpi-value { font-size: 20px; font-weight: 800; }
.header-kpi-value.accent { color: var(--success); }
.header-kpi-value.best-tool { font-size: 14px; font-weight: 600; color: var(--primary); }
.header-kpi-sep { width: 1px; height: 28px; background: var(--border); }

/* Tools Grid */
.tools-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 16px;
    margin-top: 24px;
}
.tool-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    padding: 22px;
    transition: all 0.25s ease;
    position: relative;
    overflow: hidden;
}
.tool-card:hover { border-color: var(--border-hover); }
.tool-card.featured {
    border-color: rgba(34, 197, 94, 0.2);
    background: linear-gradient(135deg, var(--bg-card) 0%, rgba(34, 197, 94, 0.03) 100%);
}
.tool-card.featured::before {
    content: '';
    position: absolute;
    top: 0; right: 0;
    width: 60px; height: 60px;
    background: radial-gradient(circle at top right, rgba(34, 197, 94, 0.12), transparent 70%);
}
.tool-card-top {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    margin-bottom: 14px;
}
.tool-icon-wrap {
    width: 44px;
    height: 44px;
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}
.tool-card-top .toggle { flex-shrink: 0; }
.tool-name {
    font-size: 15px;
    font-weight: 700;
    margin-bottom: 4px;
    display: flex;
    align-items: center;
    gap: 8px;
}
.tool-desc {
    font-size: 13px;
    color: var(--text-dim);
    margin-bottom: 16px;
    line-height: 1.5;
}
.tool-metrics {
    display: flex;
    gap: 20px;
    padding-top: 14px;
    border-top: 1px solid var(--border);
    margin-bottom: 16px;
}
.tool-metric-label { font-size: 11px; color: var(--text-dim); }
.tool-metric-value { font-size: 18px; font-weight: 800; margin-top: 2px; }
.tool-actions {
    display: flex;
    gap: 8px;
}
.tool-actions .btn { flex: 1; }

/* Config Panels */
.config-panel {
    margin-top: 24px;
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    padding: 28px;
    animation: fadeIn 0.3s ease;
}
.config-panel-header {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    margin-bottom: 28px;
    padding-bottom: 20px;
    border-bottom: 1px solid var(--border);
}

/* Builder Layout (Two columns) */
.builder-layout {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 32px;
    align-items: flex-start;
}
.builder-config { }
.builder-preview { position: sticky; top: 80px; }

.preview-label {
    font-size: 12px;
    font-weight: 600;
    color: var(--text-dim);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 16px;
    text-align: center;
}

/* Range Input */
.range-wrap {
    display: flex;
    align-items: center;
    gap: 12px;
}
.range-input {
    flex: 1;
    -webkit-appearance: none;
    height: 4px;
    background: var(--bg-hover);
    border-radius: 2px;
    outline: none;
}
.range-input::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 18px;
    height: 18px;
    border-radius: 50%;
    background: var(--primary);
    cursor: pointer;
    box-shadow: 0 2px 6px rgba(251, 191, 36, 0.3);
}
.range-value {
    font-size: 16px;
    font-weight: 800;
    color: var(--primary);
    min-width: 40px;
    text-align: center;
}

/* Color Input */
.color-input-wrap {
    display: flex;
    align-items: center;
    gap: 10px;
}
.color-input {
    width: 40px;
    height: 36px;
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    background: none;
    cursor: pointer;
    padding: 2px;
}
.color-input::-webkit-color-swatch-wrapper { padding: 0; }
.color-input::-webkit-color-swatch { border: none; border-radius: 4px; }
.color-hex { font-size: 13px; color: var(--text-dim); font-family: monospace; direction: ltr; }

/* Embed Code */
.embed-code-wrap {
    position: relative;
}
.embed-code {
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    padding: 12px 14px;
    font-size: 12px;
    color: var(--text-muted);
    font-family: 'SF Mono', monospace;
    direction: ltr;
    text-align: left;
    white-space: pre-wrap;
    word-break: break-all;
    line-height: 1.6;
    margin: 0;
    padding-left: 80px;
}
.embed-copy {
    position: absolute;
    top: 8px;
    left: 8px;
}

/* ============================================
   PHONE MOCKUP (Popup Preview)
   ============================================ */
.phone-mockup {
    width: 280px;
    margin: 0 auto;
    background: #0a0a0a;
    border-radius: 36px;
    border: 3px solid #222;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5), inset 0 0 0 1px rgba(255,255,255,0.05);
    overflow: hidden;
    position: relative;
}
.phone-notch {
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 100px;
    height: 24px;
    background: #0a0a0a;
    border-radius: 0 0 16px 16px;
    z-index: 10;
    display: flex;
    align-items: center;
    justify-content: center;
}
.phone-notch-inner {
    width: 50px;
    height: 6px;
    background: #1a1a1a;
    border-radius: 3px;
}
.phone-status-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 6px 20px;
    padding-top: 8px;
    font-size: 12px;
    font-weight: 600;
    color: #fff;
    position: relative;
    z-index: 5;
}
.phone-status-icons {
    display: flex;
    align-items: center;
    gap: 4px;
    color: #fff;
}
.phone-content {
    position: relative;
    height: 480px;
    overflow: hidden;
}
.phone-store-bg {
    padding: 12px;
    height: 100%;
}
.phone-store-nav {
    height: 20px;
    background: #1a1a1a;
    border-radius: 6px;
    margin-bottom: 12px;
}
.phone-store-hero {
    height: 80px;
    background: linear-gradient(135deg, #1a1a1a, #222);
    border-radius: 8px;
    margin-bottom: 12px;
}
.phone-store-products {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 8px;
}
.phone-product-card {
    height: 100px;
    background: #1a1a1a;
    border-radius: 8px;
}
.phone-overlay {
    position: absolute;
    inset: 0;
    background: rgba(0, 0, 0, 0.6);
    display: flex;
    align-items: flex-end;
    padding: 16px;
    backdrop-filter: blur(2px);
}
.phone-popup {
    width: 100%;
    border-radius: 20px;
    padding: 24px 20px 16px;
    text-align: center;
    position: relative;
    transition: all 0.3s ease;
    background: #111;
    border: 1px solid rgba(255,255,255,0.08);
}
.phone-popup-close {
    position: absolute;
    top: 10px;
    left: 10px;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: rgba(255,255,255,0.08);
    border: none;
    color: #888;
    font-size: 14px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
}
.phone-popup-icon {
    margin-bottom: 10px;
}
.phone-popup-title {
    font-size: 16px;
    font-weight: 800;
    color: #fff;
    margin-bottom: 6px;
    direction: rtl;
}
.phone-popup-body {
    font-size: 12px;
    color: #999;
    margin-bottom: 12px;
    direction: rtl;
    line-height: 1.5;
}
.phone-popup-discount {
    font-size: 36px;
    font-weight: 900;
    color: var(--success);
    margin-bottom: 14px;
    line-height: 1;
}
.phone-popup-cta {
    width: 100%;
    padding: 12px;
    border: none;
    border-radius: 12px;
    font-size: 15px;
    font-weight: 700;
    font-family: inherit;
    color: #fff;
    cursor: pointer;
    transition: all 0.2s;
    background: #22C55E;
    direction: rtl;
}
.phone-popup-cta:hover { filter: brightness(1.1); }
.phone-popup-footer {
    font-size: 10px;
    color: #555;
    margin-top: 10px;
    direction: rtl;
}
.phone-home-bar {
    width: 100px;
    height: 4px;
    background: #333;
    border-radius: 2px;
    margin: 10px auto;
}

/* ============================================
   WIDGET PREVIEW
   ============================================ */
.widget-preview-area {
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    height: 360px;
    position: relative;
    overflow: hidden;
}
.widget-preview-btn {
    position: absolute;
    bottom: 20px;
    right: 20px;
    width: 56px;
    height: 56px;
    border-radius: 50%;
    background: #22C55E;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 16px rgba(34, 197, 94, 0.3);
    cursor: pointer;
    transition: all 0.3s;
    animation: widgetPulse 2s ease infinite;
}
.widget-preview-btn:hover { transform: scale(1.05); }
.widget-preview-bubble {
    position: absolute;
    bottom: 84px;
    right: 16px;
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 16px 16px 4px 16px;
    padding: 12px 16px;
    font-size: 13px;
    color: var(--text);
    max-width: 200px;
    box-shadow: var(--shadow-md);
    direction: rtl;
}
.widget-preview-bubble::after {
    content: '';
    position: absolute;
    bottom: -6px;
    right: 24px;
    width: 12px;
    height: 12px;
    background: var(--bg-card);
    border-right: 1px solid var(--border);
    border-bottom: 1px solid var(--border);
    transform: rotate(45deg);
}
@keyframes widgetPulse {
    0%, 100% { box-shadow: 0 4px 16px rgba(34, 197, 94, 0.3); }
    50% { box-shadow: 0 4px 24px rgba(34, 197, 94, 0.5); }
}

/* Position toggle */
.position-toggle {
    display: flex;
    gap: 4px;
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    padding: 3px;
}
.pos-btn {
    flex: 1;
    padding: 8px 16px;
    border: none;
    border-radius: 6px;
    background: transparent;
    color: var(--text-dim);
    font-size: 13px;
    font-weight: 600;
    font-family: inherit;
    cursor: pointer;
    transition: all 0.15s;
}
.pos-btn.active {
    background: var(--primary-subtle);
    color: var(--primary);
}

/* ============================================
   QR CODE PREVIEW
   ============================================ */
.qr-preview-area {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 24px;
}
.qr-placeholder {
    width: 180px;
    height: 180px;
    background: #fff;
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
}
.qr-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 4px;
    padding: 16px;
    width: 100%;
    height: 100%;
}
.qr-block {
    border-radius: 3px;
}
.qr-block.b1 { background: #222; border-radius: 6px 3px 3px 3px; }
.qr-block.b2 { background: #ddd; }
.qr-block.b3 { background: #222; border-radius: 3px 6px 3px 3px; }
.qr-block.b4 { background: #ddd; }
.qr-block.b5 { background: transparent; }
.qr-block.b6 { background: #ddd; }
.qr-block.b7 { background: #222; border-radius: 3px 3px 3px 6px; }
.qr-block.b8 { background: #ddd; }
.qr-block.b9 { background: #222; }
.qr-logo-center {
    position: absolute;
    width: 40px;
    height: 40px;
    background: #fff;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}
.qr-actions {
    display: flex;
    gap: 8px;
}
.qr-note {
    display: flex;
    align-items: flex-start;
    gap: 8px;
    padding: 12px 14px;
    background: var(--info-subtle);
    border-radius: var(--radius-sm);
    font-size: 12px;
    color: var(--info);
    line-height: 1.5;
}
.qr-note svg { flex-shrink: 0; margin-top: 2px; }

/* ============================================
   CSV UPLOAD
   ============================================ */
.csv-upload-zone {
    border: 2px dashed var(--border);
    border-radius: var(--radius-lg);
    padding: 40px 24px;
    text-align: center;
    transition: all 0.2s;
    cursor: pointer;
    color: var(--text-muted);
}
.csv-upload-zone:hover,
.csv-upload-zone.drag-over {
    border-color: var(--primary);
    background: var(--primary-subtle);
}

/* ============================================
   ANALYTICS SECTION
   ============================================ */
.analytics-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 32px;
    align-items: flex-start;
}
.analytics-chart {
    padding: 8px 0;
}
.chart-bars {
    display: flex;
    flex-direction: column;
    gap: 14px;
}
.chart-bar-row {
    display: flex;
    align-items: center;
    gap: 12px;
}
.chart-bar-label {
    font-size: 12px;
    color: var(--text-dim);
    width: 100px;
    text-align: left;
    flex-shrink: 0;
}
.chart-bar-track {
    flex: 1;
    height: 28px;
    background: var(--bg);
    border-radius: 6px;
    overflow: hidden;
    position: relative;
}
.chart-bar-fill {
    height: 100%;
    border-radius: 6px;
    transition: width 1s ease;
    display: flex;
    align-items: center;
    padding-right: 10px;
    font-size: 12px;
    font-weight: 700;
    color: #fff;
    min-width: 40px;
}
.analytics-summary {
    display: flex;
    flex-direction: column;
    gap: 12px;
}
.summary-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 14px;
    background: var(--bg);
    border-radius: var(--radius-sm);
}
.summary-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    flex-shrink: 0;
}
.summary-info {
    flex: 1;
    display: flex;
    flex-direction: column;
}
.summary-label { font-size: 13px; font-weight: 600; }
.summary-value { font-size: 12px; color: var(--text-dim); }
.summary-pct {
    font-size: 16px;
    font-weight: 800;
    color: var(--text-muted);
}

/* ============================================
   RESPONSIVE
   ============================================ */
@media (max-width: 1024px) {
    .tools-grid { grid-template-columns: 1fr 1fr; }
    .builder-layout { grid-template-columns: 1fr; }
    .builder-preview { position: static; }
    .analytics-grid { grid-template-columns: 1fr; }
}
@media (max-width: 768px) {
    .tools-grid { grid-template-columns: 1fr; }
    .header-kpis { flex-wrap: wrap; gap: 12px; }
    .header-kpi-sep { display: none; }
    .phone-mockup { width: 250px; }
    .phone-content { height: 420px; }
}
</style>

<script src="/platform/shared/shell.js"></script>
<script>
(function() {
    'use strict';

    /* ============================================
       DATA: Tool definitions
       ============================================ */
    var tools = [
        {
            id: 'popup',
            name: 'Ø¨ÙˆØ¨ Ø§Ø¨ Ø§Ù„Ù…ØªØ¬Ø±',
            desc: 'Ø¨ÙˆØ¨ Ø§Ø¨ ÙŠØ¸Ù‡Ø± Ù„Ù„Ø²ÙˆØ§Ø± Ø§Ù„Ù„ÙŠ ÙŠØ­Ø§ÙˆÙ„ÙˆÙ† ÙŠØ·Ù„Ø¹ÙˆÙ† Ù…Ù† Ø§Ù„Ù…ØªØ¬Ø±',
            icon: '<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2"/><path d="M8 21h8"/><path d="M12 17v4"/><path d="M7 8h4"/><path d="M7 11h2"/></svg>',
            iconBg: 'rgba(34, 197, 94, 0.12)',
            iconColor: '#22C55E',
            subs: 523,
            rate: '4.2%',
            active: true,
            featured: true
        },
        {
            id: 'widget',
            name: 'ÙˆÙŠØ¯Ø¬Øª ÙˆØ§ØªØ³Ø§Ø¨',
            desc: 'Ø²Ø± ÙˆØ§ØªØ³Ø§Ø¨ Ø¹Ø§Ø¦Ù… Ø¹Ù„Ù‰ ØµÙØ­Ø§Øª Ø§Ù„Ù…ØªØ¬Ø±',
            icon: '<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>',
            iconBg: 'rgba(59, 130, 246, 0.12)',
            iconColor: '#3B82F6',
            subs: 312,
            rate: '2.8%',
            active: true,
            featured: false
        },
        {
            id: 'qr',
            name: 'ÙƒÙˆØ¯ QR',
            desc: 'ÙƒÙˆØ¯ QR Ù„Ù„Ù…Ø­Ù„ Ø§Ù„ÙØ¹Ù„ÙŠ â€” Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙŠÙ…Ø³Ø­ ÙˆÙŠØ´ØªØ±Ùƒ',
            icon: '<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="3" height="3"/><path d="M21 14h-3v3"/><path d="M14 21h3v-3"/></svg>',
            iconBg: 'rgba(251, 191, 36, 0.12)',
            iconColor: '#FBBF24',
            subs: 189,
            rate: '8.5%',
            active: true,
            featured: false
        },
        {
            id: 'social',
            name: 'Ø±Ø§Ø¨Ø· Ø³ÙˆØ´Ø§Ù„ Ù…ÙŠØ¯ÙŠØ§',
            desc: 'Ø±Ø§Ø¨Ø· Ø§Ø´ØªØ±Ø§Ùƒ Ù„Ù„Ø¨Ø§ÙŠÙˆ ÙˆØ§Ù„Ø³ØªÙˆØ±ÙŠ',
            icon: '<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/></svg>',
            iconBg: 'rgba(245, 158, 11, 0.12)',
            iconColor: '#F59E0B',
            subs: 145,
            rate: '3.1%',
            active: true,
            featured: false
        },
        {
            id: 'csv',
            name: 'Ø§Ø³ØªÙŠØ±Ø§Ø¯ CSV',
            desc: 'Ø§Ø³ØªÙˆØ±Ø¯ Ø¹Ù…Ù„Ø§Ø¦Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠÙŠÙ† Ù…Ù† Ù…Ù„Ù Ø§ÙƒØ³Ù„',
            icon: '<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>',
            iconBg: 'rgba(161, 161, 170, 0.12)',
            iconColor: '#A1A1AA',
            subs: 78,
            rate: null,
            active: false,
            featured: false,
            metricLabel: 'Ø¢Ø®Ø± Ø§Ø³ØªÙŠØ±Ø§Ø¯'
        },
        {
            id: 'landing',
            name: 'Ø±Ø§Ø¨Ø· Ù…Ø®ØµØµ',
            desc: 'ØµÙØ­Ø© Ù‡Ø¨ÙˆØ· Ù…Ø®ØµØµØ© Ù„Ø¬Ù…Ø¹ Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ†',
            icon: '<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12a9 9 0 0 1-9 9m9-9a9 9 0 0 0-9-9m9 9H3m9 9a9 9 0 0 1-9-9m9 9c1.66 0 3-4.03 3-9s-1.34-9-3-9m0 18c-1.66 0-3-4.03-3-9s1.34-9 3-9m-9 9a9 9 0 0 1 9-9"/></svg>',
            iconBg: 'rgba(139, 92, 246, 0.12)',
            iconColor: '#8B5CF6',
            subs: null,
            rate: null,
            active: false,
            featured: false,
            statusOverride: 'Ù…Ø³ÙˆØ¯Ø©',
            statusClass: 'badge-warning'
        }
    ];

    /* ============================================
       RENDER: Tool Cards
       ============================================ */
    function renderTools() {
        var grid = document.getElementById('toolsGrid');
        if (!grid) return;
        grid.innerHTML = '';
        tools.forEach(function(tool) {
            var statusBadge = '';
            if (tool.statusOverride) {
                statusBadge = '<span class="badge ' + (tool.statusClass || 'badge-neutral') + '">' + tool.statusOverride + '</span>';
            } else if (tool.active) {
                statusBadge = '<span class="badge badge-success">Ù†Ø´Ø·</span>';
            } else {
                statusBadge = '<span class="badge badge-neutral">ØºÙŠØ± Ù†Ø´Ø·</span>';
            }

            var subsDisplay = tool.subs !== null ? tool.subs.toLocaleString('ar-SA') : 'â€”';
            var rateDisplay = tool.rate || 'â€”';
            var metricLabel = tool.metricLabel || 'Ù…Ø´ØªØ±ÙƒÙŠÙ†';

            var html = '<div class="tool-card' + (tool.featured ? ' featured' : '') + '" id="tool-' + tool.id + '">' +
                '<div class="tool-card-top">' +
                    '<div class="tool-icon-wrap" style="background:' + tool.iconBg + '; color:' + tool.iconColor + ';">' + tool.icon + '</div>' +
                    '<label class="toggle">' +
                        '<input type="checkbox" ' + (tool.active ? 'checked' : '') + ' onchange="toggleTool(\'' + tool.id + '\', this.checked)">' +
                        '<span class="toggle-slider"></span>' +
                    '</label>' +
                '</div>' +
                '<div class="tool-name">' + tool.name + ' ' + statusBadge + '</div>' +
                '<div class="tool-desc">' + tool.desc + '</div>' +
                '<div class="tool-metrics">' +
                    '<div>' +
                        '<div class="tool-metric-label">' + metricLabel + '</div>' +
                        '<div class="tool-metric-value">' + subsDisplay + '</div>' +
                    '</div>' +
                    (tool.rate ? '<div><div class="tool-metric-label">Ù†Ø³Ø¨Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„</div><div class="tool-metric-value">' + rateDisplay + '</div></div>' : '') +
                '</div>' +
                '<div class="tool-actions">' +
                    '<button class="btn btn-secondary btn-sm" onclick="openConfigPanel(\'' + tool.id + '\')">' +
                        '<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09a1.65 1.65 0 0 0-1.08-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09a1.65 1.65 0 0 0 1.51-1.08 1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06c.5.5 1.21.67 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51c.61.34 1.32.17 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06c-.5.5-.67 1.21-.33 1.82V9c.27.76 1 1.25 1.82 1.31H21a2 2 0 0 1 0 4h-.09c-.83.06-1.56.55-1.82 1.31z"/></svg>' +
                        ' Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª' +
                    '</button>' +
                    '<button class="btn btn-ghost btn-sm" onclick="previewTool(\'' + tool.id + '\')">' +
                        '<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>' +
                        ' Ù…Ø¹Ø§ÙŠÙ†Ø©' +
                    '</button>' +
                '</div>' +
            '</div>';

            var div = document.createElement('div');
            div.innerHTML = html;
            grid.appendChild(div.firstChild);
        });
    }

    /* ============================================
       RENDER: Analytics Chart
       ============================================ */
    function renderChart() {
        var bars = document.getElementById('chartBars');
        if (!bars) return;

        var data = [
            { label: 'Ø¨ÙˆØ¨ Ø§Ø¨', value: 42, color: 'var(--success)' },
            { label: 'ÙˆÙŠØ¯Ø¬Øª', value: 25, color: 'var(--info)' },
            { label: 'QR', value: 15, color: 'var(--primary)' },
            { label: 'Ø³ÙˆØ´Ø§Ù„', value: 12, color: 'var(--warning)' },
            { label: 'Ø£Ø®Ø±Ù‰', value: 6, color: 'var(--text-dim)' }
        ];

        bars.innerHTML = '';
        data.forEach(function(item) {
            var row = document.createElement('div');
            row.className = 'chart-bar-row';
            row.innerHTML =
                '<div class="chart-bar-label">' + item.label + '</div>' +
                '<div class="chart-bar-track">' +
                    '<div class="chart-bar-fill" style="width:0%;background:' + item.color + ';" data-width="' + item.value + '">' +
                        item.value + '%' +
                    '</div>' +
                '</div>';
            bars.appendChild(row);
        });

        // Animate bars after a short delay
        setTimeout(function() {
            var fills = bars.querySelectorAll('.chart-bar-fill');
            fills.forEach(function(fill) {
                fill.style.width = fill.getAttribute('data-width') + '%';
            });
        }, 300);
    }

    /* ============================================
       ACTIONS: Toggle, Config Panels
       ============================================ */
    var activePanel = null;

    window.toggleTool = function(toolId, checked) {
        var tool = tools.find(function(t) { return t.id === toolId; });
        if (tool) {
            tool.active = checked;
            var card = document.getElementById('tool-' + toolId);
            if (card) {
                var badges = card.querySelectorAll('.badge');
                var statusBadge = badges[0];
                if (statusBadge && !tool.statusOverride) {
                    if (checked) {
                        statusBadge.className = 'badge badge-success';
                        statusBadge.textContent = 'Ù†Ø´Ø·';
                    } else {
                        statusBadge.className = 'badge badge-neutral';
                        statusBadge.textContent = 'ØºÙŠØ± Ù†Ø´Ø·';
                    }
                }
            }
        }
    };

    window.openConfigPanel = function(toolId) {
        // Hide all panels first
        var panels = document.querySelectorAll('.config-panel');
        panels.forEach(function(p) { p.style.display = 'none'; });

        var panel = document.getElementById('panel-' + toolId);
        if (panel) {
            panel.style.display = 'block';
            activePanel = toolId;
            panel.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
    };

    window.closeConfigPanel = function() {
        var panels = document.querySelectorAll('.config-panel');
        panels.forEach(function(p) { p.style.display = 'none'; });
        activePanel = null;
    };

    window.previewTool = function(toolId) {
        // Open config to show preview side
        openConfigPanel(toolId);
    };

    /* ============================================
       POPUP BUILDER: Live Preview
       ============================================ */
    window.updatePopupPreview = function() {
        var title = document.getElementById('popupTitle');
        var body = document.getElementById('popupBody');
        var discount = document.getElementById('popupDiscount');
        var btnColor = document.getElementById('popupBtnColor');
        var bgColor = document.getElementById('popupBgColor');
        var cta = document.getElementById('popupCta');

        if (title) {
            var previewTitle = document.getElementById('previewTitle');
            if (previewTitle) previewTitle.textContent = title.value;
        }
        if (body) {
            var previewBody = document.getElementById('previewBody');
            if (previewBody) previewBody.textContent = body.value;
        }
        if (discount) {
            var previewDiscount = document.getElementById('previewDiscount');
            var discountDisplay = document.getElementById('discountDisplay');
            if (previewDiscount) previewDiscount.textContent = discount.value + '%';
            if (discountDisplay) discountDisplay.textContent = discount.value + '%';
        }
        if (btnColor) {
            var previewCta = document.getElementById('previewCta');
            if (previewCta) previewCta.style.background = btnColor.value;
            var hex = document.getElementById('btnColorHex');
            if (hex) hex.textContent = btnColor.value.toUpperCase();
        }
        if (bgColor) {
            var popup = document.getElementById('phonePopup');
            if (popup) popup.style.background = bgColor.value;
            var hex2 = document.getElementById('bgColorHex');
            if (hex2) hex2.textContent = bgColor.value.toUpperCase();
        }
        if (cta) {
            var previewCtaBtn = document.getElementById('previewCta');
            if (previewCtaBtn) previewCtaBtn.textContent = cta.value;
        }
    };

    /* ============================================
       WIDGET: Preview + Position
       ============================================ */
    window.updateWidgetPreview = function() {
        var msg = document.getElementById('widgetMessage');
        var color = document.getElementById('widgetColor');
        if (msg) {
            var bubble = document.getElementById('widgetBubbleText');
            if (bubble) bubble.textContent = msg.value;
        }
        if (color) {
            var btn = document.getElementById('widgetBtn');
            if (btn) btn.style.background = color.value;
            var hex = document.getElementById('widgetColorHex');
            if (hex) hex.textContent = color.value.toUpperCase();
        }
    };

    window.setWidgetPos = function(pos) {
        var btns = document.querySelectorAll('.pos-btn');
        btns.forEach(function(b) { b.classList.remove('active'); });
        var active = document.querySelector('.pos-btn[data-pos="' + pos + '"]');
        if (active) active.classList.add('active');

        var wBtn = document.getElementById('widgetBtn');
        var wBubble = document.getElementById('widgetBubble');
        if (pos === 'left') {
            if (wBtn) { wBtn.style.right = 'auto'; wBtn.style.left = '20px'; }
            if (wBubble) { wBubble.style.right = 'auto'; wBubble.style.left = '16px'; wBubble.style.borderRadius = '16px 16px 16px 4px'; }
        } else {
            if (wBtn) { wBtn.style.left = 'auto'; wBtn.style.right = '20px'; }
            if (wBubble) { wBubble.style.left = 'auto'; wBubble.style.right = '16px'; wBubble.style.borderRadius = '16px 16px 4px 16px'; }
        }
    };

    /* ============================================
       EMBED CODE COPY
       ============================================ */
    window.copyEmbed = function(id) {
        var el = document.getElementById(id);
        if (!el) return;
        var text = el.textContent;
        navigator.clipboard.writeText(text).then(function() {
            var btn = el.parentNode.querySelector('.embed-copy');
            if (btn) {
                var orig = btn.innerHTML;
                btn.innerHTML = '<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="var(--success)" stroke-width="2.5"><polyline points="20 6 9 17 4 12"/></svg> ØªÙ… Ø§Ù„Ù†Ø³Ø®';
                setTimeout(function() { btn.innerHTML = orig; }, 2000);
            }
        });
    };

    /* ============================================
       SAVE CONFIGS (stub)
       ============================================ */
    window.savePopupConfig = function() {
        showToast('ØªÙ… Ø­ÙØ¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨ÙˆØ¨ Ø§Ø¨');
    };
    window.saveWidgetConfig = function() {
        showToast('ØªÙ… Ø­ÙØ¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ÙˆÙŠØ¯Ø¬Øª');
    };

    /* ============================================
       QR CODE
       ============================================ */
    window.generateQR = function() {
        var phone = document.getElementById('qrPhone');
        if (phone && !phone.value.trim()) {
            phone.style.borderColor = 'var(--danger)';
            phone.focus();
            setTimeout(function() { phone.style.borderColor = ''; }, 2000);
            return;
        }
        showToast('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ÙƒÙˆØ¯ QR');
    };

    window.downloadQR = function(format) {
        showToast('Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ ' + (format === 'pdf' ? 'PDF' : 'PNG') + '...');
    };

    /* ============================================
       CSV IMPORT
       ============================================ */
    window.handleCSVDrop = function(e) {
        e.preventDefault();
        var zone = document.getElementById('csvZone');
        if (zone) zone.classList.remove('drag-over');
        showCSVResult(Math.floor(Math.random() * 200) + 50);
    };

    window.handleCSVFile = function(input) {
        if (input.files && input.files.length > 0) {
            showCSVResult(Math.floor(Math.random() * 200) + 50);
        }
    };

    function showCSVResult(count) {
        var result = document.getElementById('csvResult');
        var countEl = document.getElementById('csvCount');
        if (result) result.style.display = 'block';
        if (countEl) countEl.textContent = count;
    }

    window.importCSV = function() {
        showToast('ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù†Ø¬Ø§Ø­');
    };

    /* ============================================
       TOAST NOTIFICATION
       ============================================ */
    function showToast(msg) {
        var existing = document.querySelector('.st-toast');
        if (existing) existing.remove();

        var toast = document.createElement('div');
        toast.className = 'st-toast';
        toast.innerHTML = '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--success)" stroke-width="2.5"><polyline points="20 6 9 17 4 12"/></svg> ' + msg;
        toast.style.cssText = 'position:fixed;bottom:24px;left:50%;transform:translateX(-50%);background:var(--bg-elevated);border:1px solid var(--border);color:var(--text);padding:12px 24px;border-radius:var(--radius-md);font-size:14px;font-weight:600;z-index:999;display:flex;align-items:center;gap:8px;box-shadow:var(--shadow-lg);animation:fadeIn 0.3s ease;';
        document.body.appendChild(toast);
        setTimeout(function() { toast.remove(); }, 3000);
    }

    /* ============================================
       COUNTER ANIMATION
       ============================================ */
    function animateCounters() {
        var counters = document.querySelectorAll('[data-count]');
        counters.forEach(function(el) {
            var target = parseInt(el.getAttribute('data-count'), 10);
            var isPlus = el.classList.contains('accent');
            var duration = 1200;
            var start = 0;
            var startTime = null;

            function step(ts) {
                if (!startTime) startTime = ts;
                var progress = Math.min((ts - startTime) / duration, 1);
                var eased = 1 - Math.pow(1 - progress, 3); // ease-out cubic
                var current = Math.floor(eased * target);
                el.textContent = (isPlus ? '+' : '') + current.toLocaleString('ar-SA');
                if (progress < 1) requestAnimationFrame(step);
            }
            requestAnimationFrame(step);
        });
    }

    /* ============================================
       LOAD DATA (API with fallback)
       ============================================ */
    function loadData() {
        if (typeof RibhShell !== 'undefined' && RibhShell.api) {
            RibhShell.api('/api/signup-tools').then(function(data) {
                if (data && data.tools) {
                    // Merge server data into tools
                    data.tools.forEach(function(serverTool) {
                        var local = tools.find(function(t) { return t.id === serverTool.id; });
                        if (local) {
                            if (serverTool.subs !== undefined) local.subs = serverTool.subs;
                            if (serverTool.rate !== undefined) local.rate = serverTool.rate;
                            if (serverTool.active !== undefined) local.active = serverTool.active;
                        }
                    });
                }
                renderTools();
            }).catch(function() {
                // Use sample data
                renderTools();
            });
        } else {
            renderTools();
        }
    }

    /* ============================================
       INIT
       ============================================ */
    function init() {
        loadData();
        renderChart();
        animateCounters();
    }

    // Wait for shell to finish rendering
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(init, 100);
        });
    } else {
        setTimeout(init, 100);
    }

})();
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… | Ø±ÙØ¨Ø­</title>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/platform/shared/shell.css">
</head>
<body>

<div id="page-content">

    <!-- ============================================
         SECTION 1: THE ONE NUMBER (Superhuman: single attribute)
         Revenue recovered = the only metric that matters
         ============================================ -->
    <div class="hero-metric">
        <div class="hero-label">Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø³ØªØ±Ø¯Ø©</div>
        <div class="hero-value" id="heroRevenue">0 <span class="hero-currency">Ø±.Ø³</span></div>
        <div class="hero-change up" id="heroChange">Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±</div>
        <div class="hero-sub-metrics">
            <div class="hero-sub">
                <span class="hero-sub-value" id="kpiMessages">0</span>
                <span class="hero-sub-label">Ø±Ø³Ø§Ù„Ø©</span>
            </div>
            <div class="hero-sub-divider"></div>
            <div class="hero-sub">
                <span class="hero-sub-value" id="kpiRecovery">0%</span>
                <span class="hero-sub-label">Ù…Ø¹Ø¯Ù„ Ø§Ø³ØªØ±Ø¯Ø§Ø¯</span>
            </div>
            <div class="hero-sub-divider"></div>
            <div class="hero-sub">
                <span class="hero-sub-value" id="kpiSubscribers">0</span>
                <span class="hero-sub-label">Ù…Ø´ØªØ±Ùƒ</span>
            </div>
        </div>
    </div>

    <!-- ============================================
         SECTION 2: AUTOMATIONS (Lindy: toggles, not pages)
         All journeys visible as compact cards with on/off toggles
         Duolingo: zero decisions, everything is ON by default
         ============================================ -->
    <div class="section-card">
        <div class="section-header">
            <div class="section-title">
                <span class="section-dot online"></span>
                Ø§Ù„Ø£ØªÙ…ØªØ© ØªØ¹Ù…Ù„
            </div>
            <span class="text-sm text-dim" id="automationStatus">3 Ø±Ø­Ù„Ø§Øª Ù†Ø´Ø·Ø©</span>
        </div>

        <div class="automation-grid" id="automationGrid">
            <!-- Active automations -->
            <div class="auto-card active">
                <div class="auto-top">
                    <div class="auto-icon" style="background: var(--warning-subtle); color: var(--warning);">ğŸ›’</div>
                    <label class="toggle"><input type="checkbox" checked onchange="toggleJourney('cart_recovery', this)"><span class="toggle-slider"></span></label>
                </div>
                <div class="auto-name">Ø§Ø³ØªØ±Ø¯Ø§Ø¯ Ø§Ù„Ø³Ù„Ø§Øª</div>
                <div class="auto-stats">
                    <span class="auto-stat text-success">30% Ø§Ø³ØªØ±Ø¯Ø§Ø¯</span>
                    <span class="auto-stat">142 Ø±Ø³Ø§Ù„Ø©</span>
                </div>
            </div>

            <div class="auto-card active">
                <div class="auto-top">
                    <div class="auto-icon" style="background: var(--info-subtle); color: var(--info);">ğŸ‘‹</div>
                    <label class="toggle"><input type="checkbox" checked onchange="toggleJourney('welcome', this)"><span class="toggle-slider"></span></label>
                </div>
                <div class="auto-name">Ø±Ø­Ù„Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨</div>
                <div class="auto-stats">
                    <span class="auto-stat">85% Ù‚Ø±Ø§Ø¡Ø©</span>
                    <span class="auto-stat">67 Ø±Ø³Ø§Ù„Ø©</span>
                </div>
            </div>

            <div class="auto-card active">
                <div class="auto-top">
                    <div class="auto-icon" style="background: var(--success-subtle); color: var(--success);">ğŸ“¦</div>
                    <label class="toggle"><input type="checkbox" checked onchange="toggleJourney('post_purchase', this)"><span class="toggle-slider"></span></label>
                </div>
                <div class="auto-name">Ù…ØªØ§Ø¨Ø¹Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø´Ø±Ø§Ø¡</div>
                <div class="auto-stats">
                    <span class="auto-stat">92% Ù‚Ø±Ø§Ø¡Ø©</span>
                    <span class="auto-stat">23% ØªÙ‚ÙŠÙŠÙ…</span>
                </div>
            </div>

            <!-- Draft automations (one-tap activate) -->
            <div class="auto-card draft">
                <div class="auto-top">
                    <div class="auto-icon" style="background: var(--danger-subtle); color: var(--danger);">ğŸ’”</div>
                    <label class="toggle"><input type="checkbox" onchange="toggleJourney('winback', this)"><span class="toggle-slider"></span></label>
                </div>
                <div class="auto-name">Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„ØºØ§Ø¦Ø¨ÙŠÙ†</div>
                <div class="auto-stats">
                    <span class="auto-stat text-dim">Ø¬Ø§Ù‡Ø² Ù„Ù„ØªÙØ¹ÙŠÙ„</span>
                </div>
            </div>

            <div class="auto-card draft">
                <div class="auto-top">
                    <div class="auto-icon" style="background: var(--primary-subtle); color: var(--primary);">ğŸ‚</div>
                    <label class="toggle"><input type="checkbox" onchange="toggleJourney('birthday', this)"><span class="toggle-slider"></span></label>
                </div>
                <div class="auto-name">ØªÙ‡Ù†Ø¦Ø© Ø¹ÙŠØ¯ Ù…ÙŠÙ„Ø§Ø¯</div>
                <div class="auto-stats">
                    <span class="auto-stat text-dim">Ø¬Ø§Ù‡Ø² Ù„Ù„ØªÙØ¹ÙŠÙ„</span>
                </div>
            </div>

            <div class="auto-card draft">
                <div class="auto-top">
                    <div class="auto-icon" style="background: rgba(139, 92, 246, 0.1); color: #8B5CF6;">ğŸ‘ï¸</div>
                    <label class="toggle"><input type="checkbox" onchange="toggleJourney('browse_abandonment', this)"><span class="toggle-slider"></span></label>
                </div>
                <div class="auto-name">Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ØªØµÙØ­</div>
                <div class="auto-stats">
                    <span class="auto-stat text-dim">Ø¬Ø§Ù‡Ø² Ù„Ù„ØªÙØ¹ÙŠÙ„</span>
                </div>
            </div>
        </div>
    </div>

    <!-- ============================================
         SECTION 3: PERFORMANCE (Superhuman: inline, not separate page)
         Analytics merged into dashboard â€” period tabs + channel bars
         ============================================ -->
    <div class="section-card">
        <div class="section-header">
            <div class="section-title">Ø§Ù„Ø£Ø¯Ø§Ø¡</div>
            <div class="period-tabs">
                <button class="period-tab active" data-period="7d">7 Ø£ÙŠØ§Ù…</button>
                <button class="period-tab" data-period="30d">30 ÙŠÙˆÙ…</button>
                <button class="period-tab" data-period="90d">90 ÙŠÙˆÙ…</button>
            </div>
        </div>

        <div class="perf-grid">
            <div class="perf-item">
                <div class="perf-value">1,847</div>
                <div class="perf-label">Ø±Ø³Ø§Ù„Ø© Ù…Ø±Ø³Ù„Ø©</div>
                <div class="perf-bar"><div class="perf-bar-fill" style="width: 100%;"></div></div>
            </div>
            <div class="perf-item">
                <div class="perf-value text-success">91%</div>
                <div class="perf-label">Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©</div>
                <div class="perf-bar"><div class="perf-bar-fill success" style="width: 91%;"></div></div>
            </div>
            <div class="perf-item">
                <div class="perf-value">24%</div>
                <div class="perf-label">Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ù‚Ø±</div>
                <div class="perf-bar"><div class="perf-bar-fill" style="width: 24%;"></div></div>
            </div>
            <div class="perf-item">
                <div class="perf-value text-success">30%</div>
                <div class="perf-label">Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„</div>
                <div class="perf-bar"><div class="perf-bar-fill success" style="width: 30%;"></div></div>
            </div>
        </div>

        <!-- Channel breakdown inline -->
        <div class="channels-inline">
            <div class="channel-row">
                <span class="channel-dot-sm" style="background: var(--success);"></span>
                <span class="channel-label">ÙˆØ§ØªØ³Ø§Ø¨</span>
                <span class="channel-val">1,420 Ø±Ø³Ø§Ù„Ø© Â· 98% ØªØ³Ù„ÙŠÙ… Â· 91% Ù‚Ø±Ø§Ø¡Ø©</span>
                <div class="channel-bar-sm"><div style="width: 77%; background: var(--success);"></div></div>
            </div>
            <div class="channel-row">
                <span class="channel-dot-sm" style="background: var(--info);"></span>
                <span class="channel-label">SMS</span>
                <span class="channel-val">427 Ø±Ø³Ø§Ù„Ø© Â· 96% ØªØ³Ù„ÙŠÙ…</span>
                <div class="channel-bar-sm"><div style="width: 23%; background: var(--info);"></div></div>
            </div>
        </div>
    </div>

    <!-- ============================================
         SECTION 4: ACTIVITY + CUSTOMERS (merged view)
         Duolingo: make progress visible
         Recent activity + customer segments as inline badges
         ============================================ -->
    <div class="grid-2">
        <!-- Activity Feed -->
        <div class="section-card">
            <div class="section-header">
                <div class="section-title">Ø¢Ø®Ø± Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª</div>
            </div>
            <div id="activityFeed">
                <div class="activity-item">
                    <div class="activity-dot" style="background: var(--success);"></div>
                    <div class="activity-content">
                        <div class="activity-text">Ù†ÙˆØ±Ø© Ø§Ø³ØªØ±Ø¯Øª Ø³Ù„ØªÙ‡Ø§ â€” <strong>350 Ø±.Ø³</strong></div>
                        <div class="activity-time">Ù‚Ø¨Ù„ 5 Ø¯Ù‚Ø§Ø¦Ù‚</div>
                    </div>
                </div>
                <div class="activity-item">
                    <div class="activity-dot" style="background: var(--primary);"></div>
                    <div class="activity-content">
                        <div class="activity-text">Ù…Ø´ØªØ±Ùƒ Ø¬Ø¯ÙŠØ¯ Ø¹Ø¨Ø± QR â€” <strong>+966 50 XXX</strong></div>
                        <div class="activity-time">Ù‚Ø¨Ù„ 12 Ø¯Ù‚ÙŠÙ‚Ø©</div>
                    </div>
                </div>
                <div class="activity-item">
                    <div class="activity-dot" style="background: var(--info);"></div>
                    <div class="activity-content">
                        <div class="activity-text">Ø±Ø³Ø§Ù„Ø© ØªØ±Ø­ÙŠØ¨ Ø£ÙØ±Ø³Ù„Øª Ù„Ù€ <strong>Ø£Ø­Ù…Ø¯</strong></div>
                        <div class="activity-time">Ù‚Ø¨Ù„ 18 Ø¯Ù‚ÙŠÙ‚Ø©</div>
                    </div>
                </div>
                <div class="activity-item">
                    <div class="activity-dot" style="background: var(--success);"></div>
                    <div class="activity-content">
                        <div class="activity-text">Ù…Ø­Ù…Ø¯ Ø§Ø´ØªØ±Ù‰ Ø¨Ø¹Ø¯ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© â€” <strong>520 Ø±.Ø³</strong></div>
                        <div class="activity-time">Ù‚Ø¨Ù„ 35 Ø¯Ù‚ÙŠÙ‚Ø©</div>
                    </div>
                </div>
                <div class="activity-item">
                    <div class="activity-dot" style="background: var(--warning);"></div>
                    <div class="activity-content">
                        <div class="activity-text">Ø³Ù„Ø© Ù…ØªØ±ÙˆÙƒØ© Ø¬Ø¯ÙŠØ¯Ø© â€” <strong>780 Ø±.Ø³</strong></div>
                        <div class="activity-time">Ù‚Ø¨Ù„ Ø³Ø§Ø¹Ø©</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Customers (segments as compact badges, not a separate page) -->
        <div class="section-card">
            <div class="section-header">
                <div class="section-title">Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</div>
                <div class="section-total" id="totalCustomers">1,247 Ù…Ø´ØªØ±Ùƒ</div>
            </div>
            <div class="segment-badges">
                <a href="/platform/subscribers.html?segment=champions" class="seg-badge" style="border-color: var(--success);">
                    <span class="seg-badge-icon">ğŸ†</span>
                    <span class="seg-badge-count" style="color: var(--success);">156</span>
                    <span class="seg-badge-name">Ø£Ø¨Ø·Ø§Ù„</span>
                </a>
                <a href="/platform/subscribers.html?segment=loyal" class="seg-badge" style="border-color: var(--info);">
                    <span class="seg-badge-icon">ğŸ’</span>
                    <span class="seg-badge-count" style="color: var(--info);">312</span>
                    <span class="seg-badge-name">Ø£ÙˆÙÙŠØ§Ø¡</span>
                </a>
                <a href="/platform/subscribers.html?segment=potential" class="seg-badge" style="border-color: var(--primary);">
                    <span class="seg-badge-icon">â­</span>
                    <span class="seg-badge-count" style="color: var(--primary);">245</span>
                    <span class="seg-badge-name">Ù…Ø­ØªÙ…Ù„ÙŠÙ†</span>
                </a>
                <a href="/platform/subscribers.html?segment=recent" class="seg-badge" style="border-color: var(--info);">
                    <span class="seg-badge-icon">ğŸ†•</span>
                    <span class="seg-badge-count" style="color: var(--info);">189</span>
                    <span class="seg-badge-name">Ø¬Ø¯Ø¯</span>
                </a>
                <a href="/platform/subscribers.html?segment=at-risk" class="seg-badge" style="border-color: var(--warning);">
                    <span class="seg-badge-icon">âš ï¸</span>
                    <span class="seg-badge-count" style="color: var(--warning);">134</span>
                    <span class="seg-badge-name">Ù…Ø¹Ø±Ø¶ÙŠÙ†</span>
                </a>
                <a href="/platform/subscribers.html?segment=dormant" class="seg-badge" style="border-color: var(--danger);">
                    <span class="seg-badge-icon">ğŸ’¤</span>
                    <span class="seg-badge-count" style="color: var(--danger);">211</span>
                    <span class="seg-badge-name">ØºØ§Ø¦Ø¨ÙŠÙ†</span>
                </a>
            </div>

            <!-- Growth tools inline (not a separate page) -->
            <div class="growth-tools">
                <div class="growth-label">Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù†Ù…Ùˆ</div>
                <div class="growth-actions">
                    <button class="growth-btn" onclick="showQRModal()">
                        <span>ğŸ“±</span> ÙƒÙˆØ¯ QR
                    </button>
                    <button class="growth-btn" onclick="copySocialLink()">
                        <span>ğŸ”—</span> Ø±Ø§Ø¨Ø· Ø§Ø´ØªØ±Ø§Ùƒ
                    </button>
                    <button class="growth-btn" onclick="showWidgetModal()">
                        <span>ğŸ’¬</span> ÙˆÙŠØ¯Ø¬Øª Ù…ØªØ¬Ø±
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- QR Modal (slide panel) -->
<div class="modal-overlay" id="qrModal">
    <div class="modal">
        <div class="modal-header">
            <div class="modal-title">ÙƒÙˆØ¯ QR ÙˆØ§ØªØ³Ø§Ø¨</div>
            <button class="modal-close" onclick="closeModal('qrModal')">&times;</button>
        </div>
        <div class="modal-body">
            <p class="text-sm text-dim mb-16">Ø§Ø·Ø¨Ø¹ ÙƒÙˆØ¯ QR Ø¹Ù„Ù‰ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø£Ùˆ Ø§Ù„ÙƒØ§ÙˆÙ†ØªØ± â€” Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙŠÙ…Ø³Ø­Ù‡ ÙˆÙŠØ´ØªØ±Ùƒ ÙÙˆØ±Ø§Ù‹</p>
            <div class="input-group">
                <label class="input-label">Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ù…ØªØ¬Ø±</label>
                <input type="tel" class="input" id="qrPhone" placeholder="966501234567" dir="ltr">
            </div>
            <button class="btn btn-primary w-full" onclick="generateQR()">Ø¥Ù†Ø´Ø§Ø¡ ÙƒÙˆØ¯ QR</button>
            <div class="qr-result" id="qrResult" style="display: none;">
                <div class="qr-preview" id="qrPreview"></div>
                <div class="qr-actions">
                    <button class="btn btn-secondary btn-sm" onclick="downloadQR('png')">ØªØ­Ù…ÙŠÙ„ PNG</button>
                    <button class="btn btn-ghost btn-sm" onclick="printQR()">Ø·Ø¨Ø§Ø¹Ø©</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Widget Info Modal -->
<div class="modal-overlay" id="widgetModal">
    <div class="modal">
        <div class="modal-header">
            <div class="modal-title">ÙˆÙŠØ¯Ø¬Øª ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ù„Ù…ØªØ¬Ø±</div>
            <button class="modal-close" onclick="closeModal('widgetModal')">&times;</button>
        </div>
        <div class="modal-body">
            <p class="text-sm text-dim mb-16">Ù†Ø§ÙØ°Ø© Ù…Ù†Ø¨Ø«Ù‚Ø© Ø°ÙƒÙŠØ© Ø¹Ù„Ù‰ Ù…ØªØ¬Ø±Ùƒ â€” ØªØ¸Ù‡Ø± Ø¹Ù†Ø¯ Ù†ÙŠØ© Ø§Ù„Ø®Ø±ÙˆØ¬ ÙˆØªØ¬Ù…Ø¹ Ø§Ø´ØªØ±Ø§ÙƒØ§Øª</p>
            <div class="code-block">
                <div class="code-label">ÙƒÙˆØ¯ Ø§Ù„ØªØ¶Ù…ÙŠÙ† â€” Ø§Ù†Ø³Ø®Ù‡ ÙˆØ£Ù„ØµÙ‚Ù‡ ÙÙŠ Ù…ØªØ¬Ø±Ùƒ:</div>
                <code class="code-text" id="widgetCode">&lt;script src="https://ribh-484706.web.app/widget/optin.js" data-store="YOUR_ID"&gt;&lt;/script&gt;</code>
            </div>
            <button class="btn btn-secondary w-full mt-16" onclick="copyWidgetCode()">Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯</button>
        </div>
    </div>
</div>

<style>
    /* ============================================
       HERO METRIC â€” The ONE number (Superhuman positioning)
       ============================================ */
    .hero-metric {
        text-align: center;
        padding: 32px 24px 24px;
        margin-bottom: 20px;
    }
    .hero-label {
        font-size: 14px;
        color: var(--text-dim);
        font-weight: 500;
        margin-bottom: 8px;
    }
    .hero-value {
        font-size: 56px;
        font-weight: 800;
        background: linear-gradient(135deg, #FBBF24, #F59E0B);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        line-height: 1.1;
        margin-bottom: 6px;
    }
    .hero-currency {
        font-size: 28px;
        font-weight: 600;
    }
    .hero-change {
        font-size: 13px;
        font-weight: 600;
        margin-bottom: 20px;
    }
    .hero-change.up { color: var(--success); }
    .hero-sub-metrics {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 24px;
    }
    .hero-sub {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 2px;
    }
    .hero-sub-value {
        font-size: 20px;
        font-weight: 700;
        color: var(--text);
    }
    .hero-sub-label {
        font-size: 12px;
        color: var(--text-faint);
    }
    .hero-sub-divider {
        width: 1px;
        height: 32px;
        background: var(--border);
    }

    /* ============================================
       SECTION CARDS â€” Unified card style
       ============================================ */
    .section-card {
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: var(--radius-lg);
        padding: 20px;
        margin-bottom: 16px;
    }
    .section-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 16px;
    }
    .section-title {
        font-size: 15px;
        font-weight: 700;
        display: flex;
        align-items: center;
        gap: 8px;
    }
    .section-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
    }
    .section-dot.online {
        background: var(--success);
        box-shadow: 0 0 6px var(--success);
    }
    .section-total {
        font-size: 14px;
        font-weight: 600;
        color: var(--text-muted);
    }

    /* ============================================
       AUTOMATION GRID â€” Compact journey cards with toggles
       (Lindy: template one-click deploy)
       ============================================ */
    .automation-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 12px;
    }
    .auto-card {
        background: var(--bg-elevated);
        border: 1px solid var(--border);
        border-radius: var(--radius-md);
        padding: 14px;
        transition: border-color 0.2s;
    }
    .auto-card:hover { border-color: var(--border-hover); }
    .auto-card.active { border-color: rgba(34, 197, 94, 0.2); }
    .auto-card.draft { opacity: 0.7; }
    .auto-card.draft:hover { opacity: 1; }
    .auto-top {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 10px;
    }
    .auto-icon {
        width: 36px;
        height: 36px;
        border-radius: var(--radius-sm);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 16px;
    }
    .auto-name {
        font-size: 13px;
        font-weight: 600;
        margin-bottom: 6px;
    }
    .auto-stats {
        display: flex;
        gap: 10px;
    }
    .auto-stat {
        font-size: 12px;
        color: var(--text-dim);
    }

    /* ============================================
       PERFORMANCE â€” Inline metrics (Superhuman: no separate page)
       ============================================ */
    .period-tabs {
        display: flex;
        gap: 4px;
    }
    .period-tab {
        padding: 4px 12px;
        font-size: 12px;
        font-weight: 600;
        color: var(--text-faint);
        background: none;
        border: 1px solid transparent;
        border-radius: 20px;
        cursor: pointer;
        font-family: inherit;
        transition: all 0.15s;
    }
    .period-tab:hover { color: var(--text-muted); }
    .period-tab.active {
        color: var(--primary);
        border-color: var(--primary);
        background: var(--primary-subtle);
    }

    .perf-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 16px;
        margin-bottom: 20px;
    }
    .perf-item {
        text-align: center;
    }
    .perf-value {
        font-size: 22px;
        font-weight: 800;
        margin-bottom: 4px;
    }
    .perf-label {
        font-size: 12px;
        color: var(--text-faint);
        margin-bottom: 8px;
    }
    .perf-bar {
        height: 4px;
        background: var(--bg-hover);
        border-radius: 2px;
        overflow: hidden;
    }
    .perf-bar-fill {
        height: 100%;
        background: linear-gradient(135deg, #FBBF24, #F59E0B);
        border-radius: 2px;
    }
    .perf-bar-fill.success {
        background: var(--success);
    }

    /* Channel rows inline */
    .channels-inline {
        display: flex;
        flex-direction: column;
        gap: 10px;
        padding-top: 16px;
        border-top: 1px solid var(--border);
    }
    .channel-row {
        display: flex;
        align-items: center;
        gap: 10px;
    }
    .channel-dot-sm {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        flex-shrink: 0;
    }
    .channel-label {
        font-size: 13px;
        font-weight: 600;
        width: 60px;
        flex-shrink: 0;
    }
    .channel-val {
        font-size: 12px;
        color: var(--text-dim);
        flex: 1;
    }
    .channel-bar-sm {
        width: 80px;
        height: 4px;
        background: var(--bg-hover);
        border-radius: 2px;
        overflow: hidden;
        flex-shrink: 0;
    }
    .channel-bar-sm > div {
        height: 100%;
        border-radius: 2px;
    }

    /* ============================================
       ACTIVITY FEED â€” Same as before but in section-card
       ============================================ */
    .activity-item {
        display: flex;
        align-items: flex-start;
        gap: 12px;
        padding: 10px 0;
        border-bottom: 1px solid var(--border);
    }
    .activity-item:last-child { border-bottom: none; }
    .activity-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        margin-top: 6px;
        flex-shrink: 0;
    }
    .activity-content { flex: 1; }
    .activity-text { font-size: 13px; color: var(--text-secondary); }
    .activity-time { font-size: 11px; color: var(--text-faint); margin-top: 2px; }

    /* ============================================
       SEGMENT BADGES â€” Compact inline view
       (Duolingo: make progress visible without separate page)
       ============================================ */
    .segment-badges {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 8px;
        margin-bottom: 20px;
    }
    .seg-badge {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 10px 12px;
        background: var(--bg-elevated);
        border: 1px solid var(--border);
        border-radius: var(--radius-sm);
        text-decoration: none;
        color: inherit;
        transition: all 0.15s;
        border-right: 3px solid;
    }
    .seg-badge:hover {
        border-color: var(--border-hover);
        transform: translateY(-1px);
    }
    .seg-badge-icon { font-size: 16px; }
    .seg-badge-count {
        font-size: 18px;
        font-weight: 800;
        line-height: 1;
    }
    .seg-badge-name {
        font-size: 12px;
        color: var(--text-dim);
    }

    /* ============================================
       GROWTH TOOLS â€” Inline buttons (not a separate page)
       ============================================ */
    .growth-tools {
        padding-top: 16px;
        border-top: 1px solid var(--border);
    }
    .growth-label {
        font-size: 12px;
        font-weight: 600;
        color: var(--text-faint);
        margin-bottom: 10px;
    }
    .growth-actions {
        display: flex;
        gap: 8px;
    }
    .growth-btn {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 8px 14px;
        background: var(--bg-elevated);
        border: 1px solid var(--border);
        border-radius: var(--radius-sm);
        font-size: 13px;
        font-weight: 500;
        color: var(--text-muted);
        cursor: pointer;
        font-family: inherit;
        transition: all 0.15s;
    }
    .growth-btn:hover {
        border-color: var(--border-hover);
        color: var(--text);
        background: var(--bg-hover);
    }

    /* ============================================
       MODALS â€” QR and Widget (slide panels)
       ============================================ */
    .qr-result { text-align: center; margin-top: 20px; }
    .qr-preview {
        width: 180px;
        height: 180px;
        margin: 0 auto 16px;
        background: #fff;
        border-radius: var(--radius-md);
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .qr-preview img { width: 160px; height: 160px; }
    .qr-actions { display: flex; gap: 8px; justify-content: center; }

    .code-block {
        background: var(--bg-elevated);
        border: 1px solid var(--border);
        border-radius: var(--radius-sm);
        padding: 12px;
    }
    .code-label { font-size: 12px; color: var(--text-dim); margin-bottom: 6px; }
    .code-text {
        display: block;
        font-size: 12px;
        color: var(--primary);
        word-break: break-all;
        font-family: monospace;
        direction: ltr;
        text-align: left;
    }

    /* ============================================
       RESPONSIVE
       ============================================ */
    @media (max-width: 1024px) {
        .automation-grid { grid-template-columns: repeat(2, 1fr); }
        .perf-grid { grid-template-columns: repeat(2, 1fr); }
    }
    @media (max-width: 768px) {
        .hero-value { font-size: 40px; }
        .hero-currency { font-size: 20px; }
        .hero-sub-metrics { gap: 16px; }
        .automation-grid { grid-template-columns: 1fr 1fr; }
        .perf-grid { grid-template-columns: 1fr 1fr; }
        .segment-badges { grid-template-columns: 1fr 1fr; }
        .growth-actions { flex-wrap: wrap; }
        .grid-2 { grid-template-columns: 1fr; }
    }
    @media (max-width: 480px) {
        .hero-value { font-size: 32px; }
        .automation-grid { grid-template-columns: 1fr; }
        .perf-grid { grid-template-columns: 1fr 1fr; }
        .segment-badges { grid-template-columns: 1fr; }
    }
</style>

<script src="/platform/shared/shell.js"></script>
<script>
    // Load real data from API
    document.addEventListener('DOMContentLoaded', function() {
        RibhShell.api('/api/stats').then(function(data) {
            if (!data) return;
            document.getElementById('heroRevenue').innerHTML =
                RibhShell.formatNumber(data.recoveredRevenue || 0) + ' <span class="hero-currency">Ø±.Ø³</span>';
            document.getElementById('kpiSubscribers').textContent = RibhShell.formatNumber(data.totalSubscribers || 0);
            document.getElementById('kpiMessages').textContent = RibhShell.formatNumber(data.messagesSent || 0);
            document.getElementById('kpiRecovery').textContent = (data.recoveryRate || 0) + '%';
        }).catch(function() {});
    });

    // Period tab switching
    document.querySelectorAll('.period-tab').forEach(function(tab) {
        tab.addEventListener('click', function() {
            document.querySelectorAll('.period-tab').forEach(function(t) { t.classList.remove('active'); });
            this.classList.add('active');
        });
    });

    // Toggle journey activation
    function toggleJourney(type, el) {
        var card = el.closest('.auto-card');
        if (el.checked) {
            card.classList.remove('draft');
            card.classList.add('active');
            RibhShell.api('/api/sequences/activate', {
                method: 'POST',
                body: { type: type }
            }).catch(function() {});
        } else {
            card.classList.remove('active');
            card.classList.add('draft');
            RibhShell.api('/api/sequences/deactivate', {
                method: 'POST',
                body: { type: type }
            }).catch(function() {});
        }
        updateAutomationStatus();
    }

    function updateAutomationStatus() {
        var active = document.querySelectorAll('.auto-card.active').length;
        document.getElementById('automationStatus').textContent = active + ' Ø±Ø­Ù„Ø§Øª Ù†Ø´Ø·Ø©';
    }

    // Modal helpers
    function showQRModal() {
        document.getElementById('qrModal').classList.add('open');
    }
    function showWidgetModal() {
        document.getElementById('widgetModal').classList.add('open');
    }
    function closeModal(id) {
        document.getElementById(id).classList.remove('open');
    }

    // Close modal on overlay click
    document.querySelectorAll('.modal-overlay').forEach(function(overlay) {
        overlay.addEventListener('click', function(e) {
            if (e.target === overlay) overlay.classList.remove('open');
        });
    });

    // QR generation
    function generateQR() {
        var phone = document.getElementById('qrPhone').value.replace(/\s/g, '');
        if (!phone) return;
        RibhShell.api('/api/qr/generate', {
            method: 'POST',
            body: { phone: phone }
        }).then(function(data) {
            if (data && data.qrDataUrl) {
                document.getElementById('qrResult').style.display = '';
                document.getElementById('qrPreview').innerHTML = '<img src="' + data.qrDataUrl + '" alt="QR">';
            }
        }).catch(function() {
            document.getElementById('qrResult').style.display = '';
            document.getElementById('qrPreview').innerHTML = '<div style="padding:20px;color:#0a0a0a;font-size:11px;">wa.me/' + phone + '</div>';
        });
    }

    function downloadQR(f) { alert('ØªØ­Ù…ÙŠÙ„ ' + f); }
    function printQR() { window.print(); }

    function copySocialLink() {
        var link = 'https://wa.me/966501234567?text=Ø§Ø´ØªØ±Ø§Ùƒ';
        navigator.clipboard.writeText(link).then(function() { alert('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·!'); });
    }

    function copyWidgetCode() {
        var code = document.getElementById('widgetCode').textContent;
        navigator.clipboard.writeText(code).then(function() { alert('ØªÙ… Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯!'); });
    }
</script>

</body>
</html>

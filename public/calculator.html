<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø³Ù„Ø§Øª Ø§Ù„Ù…ØªØ±ÙˆÙƒØ© | Ø±ÙØ¨Ø­</title>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'IBM Plex Sans Arabic', sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%);
            min-height: 100vh;
            color: #fff;
            padding: 20px;
        }
        .container {
            max-width: 500px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        .logo {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        .logo span { color: #10B981; }
        h1 {
            text-align: center;
            font-size: 1.5rem;
            margin-bottom: 30px;
            color: #a1a1aa;
            font-weight: 500;
        }
        .card {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 20px;
        }
        .input-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            color: #a1a1aa;
            font-size: 0.9rem;
        }
        input {
            width: 100%;
            padding: 15px;
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 10px;
            background: rgba(0,0,0,0.3);
            color: #fff;
            font-size: 1.1rem;
            font-family: inherit;
            text-align: center;
        }
        input:focus {
            outline: none;
            border-color: #10B981;
        }
        input::placeholder { color: #52525b; }
        .btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #10B981, #059669);
            border: none;
            border-radius: 12px;
            color: #fff;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            font-family: inherit;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(16,185,129,0.3);
        }
        .result {
            display: none;
            text-align: center;
            animation: fadeIn 0.5s ease;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .lost-money {
            font-size: 3rem;
            font-weight: 700;
            color: #EF4444;
            margin: 20px 0;
        }
        .recover-money {
            font-size: 2rem;
            font-weight: 600;
            color: #10B981;
            margin: 20px 0;
        }
        .stat-row {
            display: flex;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .stat-label { color: #a1a1aa; }
        .stat-value { font-weight: 600; }
        .cta-box {
            background: linear-gradient(135deg, #10B981, #059669);
            border-radius: 16px;
            padding: 30px;
            text-align: center;
            margin-top: 30px;
        }
        .cta-box h3 {
            font-size: 1.3rem;
            margin-bottom: 15px;
        }
        .cta-input {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        .cta-input input {
            flex: 1;
            background: rgba(255,255,255,0.2);
            border: none;
            text-align: right;
        }
        .cta-input input::placeholder { color: rgba(255,255,255,0.6); }
        .cta-btn {
            padding: 15px 25px;
            background: #fff;
            color: #059669;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            font-family: inherit;
        }
        .emoji { font-size: 4rem; margin-bottom: 10px; }
        .reset-btn {
            background: transparent;
            border: 2px solid rgba(255,255,255,0.2);
            margin-top: 15px;
        }
        .reset-btn:hover {
            background: rgba(255,255,255,0.1);
            box-shadow: none;
            transform: none;
        }
        .trust {
            text-align: center;
            margin-top: 30px;
            color: #52525b;
            font-size: 0.85rem;
        }
        .success-msg {
            display: none;
            background: rgba(16,185,129,0.2);
            border: 1px solid #10B981;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">Ø±Ù<span>Ø¨Ø­</span> ğŸ’š</div>
        <h1>ÙƒÙ… ØªØ®Ø³Ø± Ù…Ù† Ø§Ù„Ø³Ù„Ø§Øª Ø§Ù„Ù…ØªØ±ÙˆÙƒØ©ØŸ</h1>

        <div class="card" id="calculator">
            <div class="input-group">
                <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø²ÙˆØ§Ø± Ø´Ù‡Ø±ÙŠØ§Ù‹</label>
                <input type="number" id="visitors" placeholder="Ù…Ø«Ø§Ù„: 10000" value="">
            </div>
            <div class="input-group">
                <label>Ù†Ø³Ø¨Ø© Ø§Ù„Ø³Ù„Ø§Øª Ø§Ù„Ù…ØªØ±ÙˆÙƒØ© %</label>
                <input type="number" id="abandonRate" placeholder="Ø§Ù„Ù…ØªÙˆØ³Ø·: 70%" value="70">
            </div>
            <div class="input-group">
                <label>Ù…ØªÙˆØ³Ø· Ù‚ÙŠÙ…Ø© Ø§Ù„Ø³Ù„Ø© (Ø±.Ø³)</label>
                <input type="number" id="cartValue" placeholder="Ù…Ø«Ø§Ù„: 300" value="">
            </div>
            <button class="btn" onclick="calculate()">Ø§Ø­Ø³Ø¨ Ø®Ø³Ø§Ø±ØªÙŠ ğŸ“Š</button>
        </div>

        <div class="card result" id="result">
            <div class="emoji">ğŸ˜±</div>
            <p style="color: #a1a1aa;">Ø£Ù†Øª ØªØ®Ø³Ø± Ø´Ù‡Ø±ÙŠØ§Ù‹</p>
            <div class="lost-money" id="lostMoney">0 Ø±.Ø³</div>
            
            <div class="stat-row">
                <span class="stat-label">Ø³Ù„Ø§Øª Ù…ØªØ±ÙˆÙƒØ© Ø´Ù‡Ø±ÙŠØ§Ù‹</span>
                <span class="stat-value" id="abandonedCarts">0</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">Ø®Ø³Ø§Ø±Ø© Ø³Ù†ÙˆÙŠØ©</span>
                <span class="stat-value" id="yearlyLoss">0 Ø±.Ø³</span>
            </div>
            
            <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1);">
                <p style="color: #a1a1aa;">Ø±ÙØ¨Ø­ ÙŠØ³ØªØ±Ø¯ 15-25% Ù…Ù† Ø§Ù„Ø³Ù„Ø§Øª</p>
                <div class="recover-money" id="recoverMoney">0 - 0 Ø±.Ø³</div>
                <p style="color: #10B981; font-weight: 500;">Ø´Ù‡Ø±ÙŠØ§Ù‹ ÙÙŠ Ø¬ÙŠØ¨Ùƒ ğŸ’°</p>
            </div>

            <button class="btn reset-btn" onclick="reset()">Ø§Ø­Ø³Ø¨ Ù…Ø±Ø© Ø«Ø§Ù†ÙŠØ©</button>
        </div>

        <div class="cta-box" id="ctaBox" style="display: none;">
            <h3>ğŸš€ Ø§Ù†Ø¶Ù… Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</h3>
            <p style="opacity: 0.9; font-size: 0.95rem;">Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø®ØµÙ… ØªØ±Ø­ÙŠØ¨ÙŠ Ø­ØµØ±ÙŠ Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ø·Ù„Ø§Ù‚</p>
            <div class="cta-input" style="flex-direction: column; gap: 12px;">
                <input type="email" id="email" placeholder="Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" style="text-align: right;">
                <input type="tel" id="phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„ (05XXXXXXXX)" dir="ltr" style="text-align: left;">
                <button class="cta-btn" onclick="joinWaitlist()" style="width: 100%; padding: 18px;">Ø§Ù†Ø¶Ù… Ø§Ù„Ø¢Ù† ğŸ</button>
            </div>
            <p style="font-size: 0.8rem; opacity: 0.7; margin-top: 10px;">ğŸ“± Ø³Ù†Ø±Ø³Ù„ Ù„Ùƒ ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ… Ø¹Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨</p>
            <div class="success-msg" id="successMsg">
                âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„Ùƒ! ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ§ØªØ³Ø§Ø¨ Ù„ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ… ğŸ‰
            </div>
            <div class="error-msg" id="errorMsg" style="display: none; background: rgba(239,68,68,0.2); border: 1px solid #EF4444; border-radius: 10px; padding: 15px; text-align: center; margin-top: 15px; color: #EF4444;">
            </div>
        </div>

        <p class="trust">ğŸ”’ Ù„Ø§ Ù†Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ â€¢ Ø£Ø¯Ø§Ø© Ù…Ø¬Ø§Ù†ÙŠØ© Ù…Ù† Ø±ÙØ¨Ø­</p>
    </div>

    <script>
        function calculate() {
            const visitors = parseInt(document.getElementById('visitors').value) || 0;
            const abandonRate = parseInt(document.getElementById('abandonRate').value) || 70;
            const cartValue = parseInt(document.getElementById('cartValue').value) || 0;

            if (visitors === 0 || cartValue === 0) {
                alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ø¯Ø¯ Ø§Ù„Ø²ÙˆØ§Ø± ÙˆÙ…ØªÙˆØ³Ø· Ù‚ÙŠÙ…Ø© Ø§Ù„Ø³Ù„Ø©');
                return;
            }

            // Assume 30% of visitors add to cart
            const addToCartRate = 0.30;
            const cartsCreated = visitors * addToCartRate;
            const abandonedCarts = Math.round(cartsCreated * (abandonRate / 100));
            const lostMoney = abandonedCarts * cartValue;
            const yearlyLoss = lostMoney * 12;
            const recoverMin = Math.round(lostMoney * 0.15);
            const recoverMax = Math.round(lostMoney * 0.25);

            document.getElementById('lostMoney').textContent = lostMoney.toLocaleString() + ' Ø±.Ø³';
            document.getElementById('abandonedCarts').textContent = abandonedCarts.toLocaleString();
            document.getElementById('yearlyLoss').textContent = yearlyLoss.toLocaleString() + ' Ø±.Ø³';
            document.getElementById('recoverMoney').textContent = recoverMin.toLocaleString() + ' - ' + recoverMax.toLocaleString() + ' Ø±.Ø³';

            document.getElementById('calculator').style.display = 'none';
            document.getElementById('result').style.display = 'block';
            document.getElementById('ctaBox').style.display = 'block';
        }

        function reset() {
            document.getElementById('calculator').style.display = 'block';
            document.getElementById('result').style.display = 'none';
            document.getElementById('ctaBox').style.display = 'none';
        }

        async function joinWaitlist() {
            const email = document.getElementById('email').value;
            const phone = document.getElementById('phone').value;
            const errorMsg = document.getElementById('errorMsg');
            errorMsg.style.display = 'none';
            
            if (!email || !email.includes('@')) {
                errorMsg.textContent = 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¨Ø±ÙŠØ¯ ØµØ­ÙŠØ­';
                errorMsg.style.display = 'block';
                return;
            }
            
            // Validate Saudi phone
            const cleanPhone = phone.replace(/\D/g, '');
            if (!cleanPhone || cleanPhone.length < 9) {
                errorMsg.textContent = 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø¬ÙˆØ§Ù„ ØµØ­ÙŠØ­ (Ù…Ø«Ø§Ù„: 05XXXXXXXX)';
                errorMsg.style.display = 'block';
                return;
            }

            try {
                const res = await fetch('https://ribh-app.onrender.com/api/leads/capture', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        email,
                        phone,
                        merchantId: 'waitlist',
                        source: 'calculator'
                    })
                });
                
                const data = await res.json();
                
                if (!data.success) {
                    errorMsg.textContent = data.message || 'Ø­Ø¯Ø« Ø®Ø·Ø£ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰';
                    errorMsg.style.display = 'block';
                    return;
                }
                
                // Show success with discount info
                const successMsg = document.getElementById('successMsg');
                successMsg.innerHTML = `âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„Ùƒ! Ø®ØµÙ…Ùƒ Ø§Ù„Ø­ØµØ±ÙŠ <strong>${data.discount}</strong> ÙÙŠ Ø·Ø±ÙŠÙ‚Ù‡ Ø¹Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨ ğŸ‰`;
                successMsg.style.display = 'block';
                
            } catch(e) {
                // Show success anyway (capture might have worked)
                document.getElementById('successMsg').style.display = 'block';
            }

            document.getElementById('email').disabled = true;
            document.getElementById('phone').disabled = true;
            document.querySelector('.cta-btn').disabled = true;
            document.querySelector('.cta-btn').textContent = 'âœ“ ØªÙ…';
        }
    </script>
</body>
</html>
